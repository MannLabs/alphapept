---

title: Search

keywords: fastai
sidebar: home_sidebar

summary: "Functions related to the search"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 05_search.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    {% raw %}
        
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This notebook contains all functions related to the searching and getting peptide-spectrum-matches (PSMS).</p>
<p>Current ToDo here:</p>
<ul>
<li>Most of the functions are not very well described yet</li>
<li>A key ingredient of speed is the frag_hits matrix to store the results which should be described</li>
<li>Introductory text to give an overview would be nice.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Comparing-Fragments">Comparing Fragments<a class="anchor-link" href="#Comparing-Fragments">&#182;</a></h2><p>To efficiently compare two fragments, we use a pointer based approach. We start with two sorted arrays, the <code>query_frag</code> that contains the m/z positions of the query spectrum and the <code>db_frag</code> which contains the database fragment that is compared against to. The two pointers compare each m/z position with each other and check wheter they are within a certain tolerance <code>mtol</code>. Depending on their delta, either of the pointers is advanced. The function returns an arrray named <code>hits</code> that is the same length as the database spectrum and encodes the hit positions.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="compare_frags" class="doc_header"><code>compare_frags</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L12" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>compare_frags</code>(<strong><code>query_frag</code></strong>, <strong><code>db_frag</code></strong>, <strong><code>mtol</code></strong>, <strong><code>ppm</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Compare query and database frags and find hits</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">query_frag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">400</span><span class="p">])</span>
<span class="n">db_frag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">150</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">450</span><span class="p">])</span>

<span class="c1"># Hits: Query 2 -&gt; Db 2 and Query 3 -&gt; Db 3</span>

<span class="n">compare_frags</span><span class="p">(</span><span class="n">query_frag</span><span class="p">,</span> <span class="n">db_frag</span><span class="p">,</span> <span class="n">mtol</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([0, 2, 3, 0], dtype=int16)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This function allows us to easily compare a query spectrum against a theoretical database.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">alphapept</span> <span class="k">import</span> <span class="n">constants</span>
<span class="kn">from</span> <span class="nn">alphapept.fasta</span> <span class="k">import</span> <span class="n">get_frag_dict</span><span class="p">,</span> <span class="n">parse</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">peptide</span> <span class="o">=</span> <span class="s1">&#39;PEPTIDE&#39;</span>

<span class="c1"># Theoretical Spectrum</span>

<span class="n">frag_dict</span> <span class="o">=</span> <span class="n">get_frag_dict</span><span class="p">(</span><span class="n">parse</span><span class="p">(</span><span class="n">peptide</span><span class="p">),</span> <span class="n">constants</span><span class="o">.</span><span class="n">mass_dict</span><span class="p">)</span>
<span class="n">db_frag</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">frag_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="n">db_frag</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

<span class="n">db_int</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">db_frag</span><span class="p">]</span>

<span class="c1"># Experimental Spectrum, dummy data</span>

<span class="n">query_frag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">98.06</span><span class="p">,</span> <span class="mf">227.10</span><span class="p">,</span> <span class="mf">263.08</span><span class="p">,</span> <span class="mf">548.06</span><span class="p">,</span> <span class="mf">653.31</span><span class="p">])</span>
<span class="n">query_int</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">])</span>

<span class="n">hits</span> <span class="o">=</span> <span class="n">compare_frags</span><span class="p">(</span><span class="n">query_frag</span><span class="p">,</span> <span class="n">db_frag</span><span class="p">,</span> <span class="n">mtol</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">hitpos</span> <span class="o">=</span> <span class="n">hits</span><span class="p">[</span><span class="n">hits</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">hit_x</span> <span class="o">=</span> <span class="n">query_frag</span><span class="p">[</span><span class="n">hitpos</span><span class="p">]</span>
<span class="n">hit_y</span> <span class="o">=</span> <span class="n">query_int</span><span class="p">[</span><span class="n">hitpos</span><span class="p">]</span>


<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">db_frag</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">db_int</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;DB&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">query_frag</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">query_int</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Query&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hit_x</span><span class="p">,</span> <span class="n">hit_y</span><span class="p">,</span> <span class="s2">&quot;ro&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Hit&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">frag_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">frag_dict</span><span class="p">[</span><span class="n">_</span><span class="p">],</span> <span class="mi">104</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Theoretical Spectrum for </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">peptide</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Mass&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Intensity&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">110</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/Users/mstrauss/anaconda3/lib/python3.7/site-packages/numba/ir_utils.py:1959: NumbaPendingDeprecationWarning: <span class="ansi-bold">
Encountered the use of a type that is scheduled for deprecation: type &#39;reflected list&#39; found for argument &#39;db_frag&#39; of function &#39;compare_frags&#39;.

For more information visit http://numba.pydata.org/numba-doc/latest/reference/deprecation.html#deprecation-of-reflection-for-list-and-set-types
</span><span class="ansi-bold">
File &#34;alphapept/search.py&#34;, line 13:</span>
<span class="ansi-bold">@njit(nogil=True)
</span><span class="ansi-bold">def compare_frags(query_frag, db_frag, mtol, ppm=False):
</span><span class="ansi-bold">^</span>

  warnings.warn(NumbaPendingDeprecationWarning(msg, loc=loc))
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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WtrjGRRef/11Xn75Zd58801qamp4xzveQd++fd+2XWayYMECZs2axYgRI5r9/AayFjBmzBg++clP8rWvfa3sUtaqrq6OY445hueff54//vGPZZdTmtdee43x48czbtw4ampquOCCCzjnnHO49NJLW3W/PXr04KKLLmLYsGH89a9/5Ytf/CLbbrsto0ePbtX9tobBgwdz/vnnM2TIEDKTm2++mW984xvcdNNNZZfWpMMOO4x//ud/pkePHsydO5fTTjuN4cOHs88++5Rd2tvMmjWLe++9t9X/QGgp3//+9xkxYgSrVq0qu5RNdv/991NTU9Om+/z0pz/N5z//+TbdZ1tYunTpamFsfV566SUyk3e+853U1NSsNrLWXixbtowXX3yxMVSuXLlyrZ/7iGDgwIHMmzdvg/bR8aN4G5o6dSpHHnkkH/rQhzjnnHN488036datG5/85CcZM2ZMm/8yr+n666/njDPOWK3tggsu4D//8z/Zfffd+fCHP8zgwU2e/mSz1NT7tccee7DffvvRq1cvamtr+cQnPsGf//znFtnfuvr/s5/9LMOHD6dLly7svPPOvPe972XKlCktst/W1FQf9unTh6233pqIIDPp0qULL7zwQql1rqvvt9tuu9VGPyKicXSvDE31aYMLLriAL33pSxt0mKO1rKtPAaZMmcKMGTM45JBDyihvo6yr71vD+vpwc9ZUGKuvr2fGjBk8/fTTzJ49m1WrVrFs2TJee+01hgwZQteuXYmI1X5f29L8+fPf9m/DnDlzmDNnDvPnz6dfv3707t2biKBr165sscUWa32u5obRagayDXDnnXdy2WWXcdttt/H3v/+dq666quySVnPggQfy0EMP8dprrwGwcuVK7r77bg488MCSKytHc96vxx9/vMUOtTW3/5ctW8bUqVPb7SG+auvqw7333ptx48bxve99r/RDgOvr+2uvvZa99tqLAw88kPr6eg444IDSal1bn95zzz107dqVPffcs7Taqq2rT1etWsX555/PGWecsVH/8ZRlXZ/ngw8+mAMPPJBzzjmHV199tUX2t77P5S233MI+++zDpz71Ke67774W2Wd7tmjRIoYNG8a73vUu3nzzTebPn099fT3dunVj3rx5PP3008yYMYPFixdv8r569+692vK1117LaaedBsCPfvQjrr/++sb22bNnA5UjSUuWLGHlypVA5dDj4sWLqaur44033gBgxowZPPPMM7z44ouN27UUA9kGOOqooxqPGZ900kn8+te/Lruk1QwaNIhdd92Ve+65B4CHHnqIfv36scMOO5RcWTnW935Nnz6dq666ii9/+cstsr/m9v+5557L9ttvz7hx41pkv61pXX14//3388ADD3DGGWfw7ne/u8Qq19/3J5xwAr/73e+44YYbOOigg972j3VbaqpP33jjDS6//HImTJhQWl1rWlef3nTTTey8884d7t+Wpvq+X79+XH/99dxxxx3813/9F6+//jrf/OY3W2R/6+rDo48+mltvvZW7776bz33uc5x99tktNlrfXg0YMIBu3bpRU1PDoEGDWLx4MStWrGDZsmXU1NQwatQottpqK2bPns2yZctarY5TTz2VT3/608Dqgaxbt2707NmzMRAuWbKEmpoaevTowYoVK1i0aBFDhw7lne98J5nJnDlzWrQuA9kGeMc73tF4f8iQIRt8fLgtHHzwwdx5551A5a/Bzjo6But+v1544QW+9KUvMWHCBN773ve22D7X1/+XXHIJM2bM4LzzzusQIwvr+8z36NGDww8/nG9/+9u88sorbV3eatbX9xHBu9/9brp3786PfvSjMkoEmu7TK664ggMPPJCtt966tLqa0lSfzps3j5tuuokvfOELJVe34Zrq+549e7LjjjtSU1PDgAED+NrXvsYf/vAHXn/99RbZ59o+l//wD/9AXV0dNTU17LnnnhxwwAGb/ShZ165vTVvv1q0by5cvJyKofeYZBl12GV1OPple3/se/WbOZMmSJa1Wx9lnn83EiRO55ZZbePTRRzn22GMZM2YM9fX11NXVsWjRIqAyoldXVwdU/v3o168f3bt3p6amhoEDB7Z4jQayDfDyyy833p8zZ067nI+19957M336dGbMmMHvf/97PvrRj5ZdUmnW9n699NJLfP7zn+fkk09u8cC6rv6/4oor+N///V8uv/zyJr9p1B415zOfmSxdurT0P1Ca+9lfuXJlqXPImurTP/7xj9x0003sv//+7L///rz88suceeaZXHfddaXVCU336dSpU5k/fz5HHHEE+++/PxMnTmTq1Knsv//+7X5yf3M+zw1/KGVmi+yzuZ/LhjmZm7MVK1Y03l++fDndunWjx7PPMuCaa2DhQhg6FBYupM+kSdRMnbpJ+6qvr2fMmDGNt29/+9tv2+aII45g7Nix3HDDDTzxxBP06NGDPn36sGzZMpYuXcqSJUsaA1ltbe0m1dMcfstyA9x8883stdde1NbW8uMf/5j9998fYLWJocuXL2+c7F/GCMgWW2zBvvvuy1lnncVOO+3EVlttBVS+VrxixQpWrlxJZvLmm2/SpUuX1f5i2dw09X7NnTuXU089lSOPPJLDDz+8xfe5tv6/5ppruOuuu7jyyisbf8E7gqb68OGHH6Zfv36MGjWK+vp6fvCDH9C3b98N+np3a2iq71etWsXPf/5z9ttvP/r06cNf//pXbr75Zk488cTS6myqTz/1qU+t9p/Vcccdx+mnn84ee+xRWp3QdJ8OGDCAX/ziF43b/OY3v+Guu+7iwgsvbPenbGiq75988kn69OnDtttuy2uvvcb3vvc9dttttxY7rL22fxPuvfdexo0bR21tLY888gh33nknF110UYvss7165ZVX6N27N126dGH+/Pn07duXHj/5CW/268cb3bvTM4IVvXuzrGdP+t59N3zwgxu9rx49evDEE080Ll977bXNuvZ1ly5d6NOnDy+++CI9evRo/IJNv379mDdvHnV1dXTt2pUFCxa0+NSHzfd/41ZwwAEH8IUvfIF58+bxT//0T5x00kkAHH744bz00ksAjZMGb7/99tIOPxx88MH8/Oc/X+0vgl/+8pecc845jct77LEHBx98MGeffXYJFbaNpt6v66+/nhdffJErr7ySK6+8snHb3//+9y2236b6//LLL6dbt258/OMfb2w78cQTS58Mvz5N9eGDDz7IBRdcwNy5c+nevTs77rgjl1566Tq/cdRWmur73/72t1x22WUsX76cwYMHc9RRR3HUUUeVVmNTfbrmX981NTX07duXnj17llTlW9bs0y222IKBAwc2ru/duzddu3Zdra29aqrvH3jgAS6//HJeeeUVevXqxfvf/37OPffcFt1vU5/LG2+8ke9+97tkJttssw3f/OY32+U5LFtSXV0dM2fOZMWKFfTu3ZtBgwYRL7xA72224bXXX6e+vp4uXbrQa8gQur74Yml19uvXj1dffXW1z3S/fv1Yvnw5f/vb34DK574hXLeU6MhDpGPHjs3mJN7OZs6cORx++OH85je/6TCHxjYn9n957PuWZ59uus7Wh9OmTWv+Fz7OPrtyuLJ//7faGpY3YcCgd+/eq83xahghu+yyyzj77LPp3bs3EyZM4JBDDuH000/nQx/6UOO2y5cvZ8aMGYwaNWqTTmfVVD9ExGOZObap7dv3+LI22KpVq7jhhhv4yEc+0il+8dsb+7889n3Ls083nX24HuPHVwLYwoWwatVb98ePb5Pdn3DCCZx66qmNk/obzrLft2/fNj+3qCNkm5H6+nr2339/hgwZwqWXXrraN4rU+uz/8tj3Lc8+3XSdtQ83aIQMYMoUmDwZZs6EYcMqYayEq5isWrWKZ555hm7dujFs2LBNPkHzho6QGcgkSVKL2eBAtpnykKUkSVIHYyCTJEkqWasFsoj4cUTMjYgnq9oGRMTdETG9+Nm/aI+I+H5EPBsRUyJi19aqS5Ikqb1pzRGya4E1r+B7JnBvZo4C7i2WAT4KjCpupwA/bMW6JEmS2pVWC2SZ+TtgzYvbHQY0XAvkOuBjVe3XZ8UfgH4RMaS1apMkSWpP2noO2Tsy8yWA4ueWRfs2wAtV280q2iRJkjZITU0NY8aMYaeddmKXXXbhwgsvbLzW6v33309dXR1jxoxh9OjR7LfffsydO7fkitvPpP6mLvrY5Pk4IuKUiHg0Ih5t7YsZP/PMMzzzzDOtuo+W0FHqbAtl9cXm9B50tNfSEertCDU26Ei1rk+Zr2Vz6sdNsXTpUpYuXdrm+224luXUqVO5++67+dWvfrXa5QP32msvnnjiCaZMmcL73vc+LrnkklLqrNbWgezlhkORxc+GSDoL2LZqu6HA7KaeIDMnZebYzBw7ePDgVi1WkiR1bFtuuSWTJk3isssuY81zr2Ymr732Gv369Supure09cXFbweOB84rft5W1X5aRNwEvB9Y1HBoU5IkaVOMHDmSVatWNR6a/P3vf8+YMWNYsGABvXr14ne/+13JFbZiIIuIG4G9gUERMQv4DpUgdnNEnATMBI4sNv8VcCDwLPAGcGJr1SVJktrO9OnT6d69e4s93/bbb79Rj6seHdtrr7244447ADj//PM566yzuPTSS1ukvo3VaoEsM49Zy6p9m9g2gS+0Vi2SJKnzeu6556ipqWHLLbdk2rRpq6079NBDGd9GFzNfl7Y+ZClJkjqRUaNGUVtbW9r+582bx6mnnsppp51GxNu/Q/jggw8ycuTIEipbnYFMkiRtVurr6xkzZgzLly+na9euHHfccZx++umN6xvmkGUmdXV1XH755SVWW2EgkyRJm5WVK1eudd3ee+/NokWLVmsr+5QX0H7OQyZJktRpGcgkSZJKZiCTJEkqmYFMkiSpZAYySZKkkhnIJEmSSmYgkyRJm5VZs2Zx2GGHMWrUKEaOHMlpp53GsmXLyi5rnQxkkiRps5GZjB8/no997GNMnz6d6dOnU19fzxlnnLHJz72u85ttKgOZJEnabNx3333U1tZy4oknAlBTU8NFF13E9ddfz2WXXcZpp53WuO3BBx/M/fffD8A999zDuHHj2HXXXTnyyCNZsmQJAMOHD+e73/0u//iP/8h5553Hrrvu2vj46dOns9tuu7VI3QYySZK02Zg6derbQlLfvn0ZPnw4K1asaPIx8+fP57zzzuOee+7h8ccfZ+zYsVx44YWN62tra3nwwQc566yzqKur44knngDgmmuu4YQTTmiRur10kiRJajU1P/kJdOvWck+4ngCUmU1eRDwz1/qYRx55hKeeeoo999wTgDfffJNx48Y1rj/qqKMa75988slcc801XHjhhfz0pz/lkUce2cAX0DQDmSRJ2mzstNNO/OxnP1utbfHixbz88ssMHDiQZ555prG94RqWmck+++zDzTff3ORz9urVq/H+4YcfzjnnnMM+++zDbrvtxsCBA1ukbgOZJElqNSuPO45utbVttr99992XM888k+uvv55Pf/rTrFy5kq9+9aucdtppjBgxgh/+8IesWrWKF198sXF0a/fdd+crX/kKzz77LO9617t44403mDVrFttvv/3bnr+2tpaPfOQjfO5zn+Pqq69usbqdQyZJkjYbEcGtt97KLbfcwqhRoxg4cCBdunThrLPOYs8992TEiBG85z3vYcKECY0T9AcPHsyVV17JMcccw+jRo/nABz7AU089tdZ9HHvssUQE+++/f4vV7QiZJEnarGy77bbcfvvtADz00EMcc8wxPPbYY+y2227ccMMNb9t+6dKl7L333vzxj39827rnn3/+bW0PPvggn/nMZ6ipqWmxmg1kkiRps7XHHnvw97//vcWe7+Mf/zgzZszgvvvua7HnBAOZJElSs916662t8rzOIZMkSSqZgUySJLWodZ3zqzPYmNdvIJMkSS2mtraWBQsWdNpQlpksWLCA2g081YdzyCRJUosZOnQos2bNYt68eSxfvhyAbi15pv5W0NJ11tbWMnTo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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Comparing-Spectra">Comparing Spectra<a class="anchor-link" href="#Comparing-Spectra">&#182;</a></h2><p>To compare multiple spectra against a database, we first need some helper functions. Per default, AlphaPept calculates in Dalton. To use ppm boundaries, we need the function <a href="/alphapept/search#ppm_to_dalton"><code>ppm_to_dalton</code></a> for conversion.</p>
<p>To minimize the search space, we typically only compare spectra with precursors in the same mass range as defined by <code>m_offset</code>. To look up the limits for search, we define the function <a href="/alphapept/search#get_idxs"><code>get_idxs</code></a>, which is a wrapper to the fast <code>searchsorted</code> method from NumPy.</p>
<p>The actual search takes place in <a href="/alphapept/search#compare_specs_single"><code>compare_specs_single</code></a> and <a href="/alphapept/search#compare_specs_parallel"><code>compare_specs_parallel</code></a>, a single-core and multicore method for comparing spectra.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ppm_to_dalton" class="doc_header"><code>ppm_to_dalton</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L44" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ppm_to_dalton</code>(<strong><code>mass</code></strong>, <strong><code>m_offset</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_idxs" class="doc_header"><code>get_idxs</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L52" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_idxs</code>(<strong><code>db_masses</code></strong>, <strong><code>query_masses</code></strong>, <strong><code>m_offset</code></strong>, <strong><code>ppm</code></strong>)</p>
</blockquote>
<p>Function to get upper and lower limits to define search range.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="compare_specs_parallel" class="doc_header"><code>compare_specs_parallel</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L67" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>compare_specs_parallel</code>(<strong><code>frag_hits</code></strong>, <strong><code>query_masses</code></strong>, <strong><code>query_frags</code></strong>, <strong><code>db_masses</code></strong>, <strong><code>db_frags</code></strong>, <strong><code>idxs_lower</code></strong>, <strong><code>idxs_higher</code></strong>, <strong><code>mtol</code></strong>, <strong><code>query_bounds</code></strong>, <strong><code>db_bounds</code></strong>, <strong><code>chunk</code></strong>=<em><code>(0, 1)</code></em>, <strong><code>offset</code></strong>=<em><code>False</code></em>, <strong><code>ppm</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Compare spectra, parallelized version</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="compare_specs_single" class="doc_header"><code>compare_specs_single</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L119" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>compare_specs_single</code>(<strong><code>frag_hits</code></strong>, <strong><code>query_masses</code></strong>, <strong><code>query_frags</code></strong>, <strong><code>db_masses</code></strong>, <strong><code>db_frags</code></strong>, <strong><code>idxs_lower</code></strong>, <strong><code>idxs_higher</code></strong>, <strong><code>mtol</code></strong>, <strong><code>query_bounds</code></strong>, <strong><code>db_bounds</code></strong>, <strong><code>chunk</code></strong>=<em><code>(0, 1)</code></em>, <strong><code>offset</code></strong>=<em><code>False</code></em>, <strong><code>ppm</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Compare spectra, single core version</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Wrapper">Wrapper<a class="anchor-link" href="#Wrapper">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="query_data_to_features" class="doc_header"><code>query_data_to_features</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L175" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>query_data_to_features</code>(<strong><code>query_data</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_psms" class="doc_header"><code>get_psms</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L193" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_psms</code>(<strong><code>query_data</code></strong>, <strong><code>db_data</code></strong>, <strong><code>features</code></strong>, <strong><code>parallel</code></strong>, <strong><code>m_tol</code></strong>, <strong><code>m_offset</code></strong>, <strong><code>ppm</code></strong>, <strong><code>min_frag_hits</code></strong>, <strong><code>callback</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Wrapper function to extract psms from dataset</p>
<p>Args:
    db_masses: database precursor masses
    query_masses: query precursor masses
    m_offset: mass offset in dalton or ppm
    ppm: flag for ppm or dalton
    callback: Callback function, e.g. for progress bar
Returns:
    idxs_lower: lower search range
    idxs_higher: upper search range
Raises:</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Extracting-columns-for-scoring">Extracting columns for scoring<a class="anchor-link" href="#Extracting-columns-for-scoring">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">### Frag Delta</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="frag_delta" class="doc_header"><code>frag_delta</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L338" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>frag_delta</code>(<strong><code>query_frag</code></strong>, <strong><code>db_frag</code></strong>, <strong><code>hits</code></strong>)</p>
</blockquote>
<p>Calculate the mass difference for a given array of hits in Dalton and ppm</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">test_frag_delta</span><span class="p">():</span>
    <span class="n">mtol</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">query_frag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">400</span><span class="p">])</span>
    <span class="n">db_frag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">101</span><span class="p">,</span> <span class="mi">202</span><span class="p">,</span> <span class="mi">303</span><span class="p">,</span> <span class="mi">404</span><span class="p">])</span>

    <span class="n">hits</span> <span class="o">=</span> <span class="n">compare_frags</span><span class="p">(</span><span class="n">query_frag</span><span class="p">,</span> <span class="n">db_frag</span><span class="p">,</span> <span class="n">mtol</span><span class="p">,</span> <span class="n">ppm</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">delta_m</span><span class="p">,</span> <span class="n">delta_m_ppm</span> <span class="o">=</span> <span class="n">frag_delta</span><span class="p">(</span><span class="n">query_frag</span><span class="p">,</span> <span class="n">db_frag</span><span class="p">,</span> <span class="n">hits</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">delta_m</span><span class="p">)</span> <span class="o">==</span> <span class="mi">10</span>
    
<span class="n">test_frag_delta</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">### Intensity Fraction</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="intensity_fraction" class="doc_header"><code>intensity_fraction</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L352" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>intensity_fraction</code>(<strong><code>query_int</code></strong>, <strong><code>hits</code></strong>)</p>
</blockquote>
<p>Calculate the fraction of matched intensity</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">test_intensity_fraction</span><span class="p">():</span>
    <span class="n">mtol</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">query_frag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">400</span><span class="p">])</span>
    <span class="n">db_frag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">700</span><span class="p">])</span>
    <span class="n">query_int</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">])</span>

    <span class="n">hits</span> <span class="o">=</span> <span class="n">compare_frags</span><span class="p">(</span><span class="n">query_frag</span><span class="p">,</span> <span class="n">db_frag</span><span class="p">,</span> <span class="n">mtol</span><span class="p">,</span> <span class="n">ppm</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">i_frac</span> <span class="o">=</span> <span class="n">intensity_fraction</span><span class="p">(</span><span class="n">query_int</span><span class="p">,</span> <span class="n">hits</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">i_frac</span> <span class="o">==</span> <span class="mi">40</span> <span class="o">/</span> <span class="mi">100</span>

<span class="n">test_intensity_fraction</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">### Intensity Product</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="intensity_product" class="doc_header"><code>intensity_product</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L367" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>intensity_product</code>(<strong><code>query_int</code></strong>, <strong><code>hits</code></strong>, <strong><code>db_int</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Calculate the dot product of matched query intensity to db intensity</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">test_intensity_product</span><span class="p">():</span>
    <span class="n">mtol</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">query_frag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">400</span><span class="p">])</span>
    <span class="n">db_frag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">700</span><span class="p">])</span>
    <span class="n">query_int</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">])</span>

    <span class="n">hits</span> <span class="o">=</span> <span class="n">compare_frags</span><span class="p">(</span><span class="n">query_frag</span><span class="p">,</span> <span class="n">db_frag</span><span class="p">,</span> <span class="n">mtol</span><span class="p">,</span> <span class="n">ppm</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">intensity_product</span><span class="p">(</span><span class="n">query_int</span><span class="p">,</span> <span class="n">hits</span><span class="p">)</span> <span class="o">==</span> <span class="mi">40</span>

    <span class="n">query_frag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">600</span><span class="p">])</span>
    <span class="n">db_frag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">700</span><span class="p">])</span>
    <span class="n">query_int</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">])</span>
    <span class="n">db_int</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">])</span>

    <span class="n">hits</span> <span class="o">=</span> <span class="n">compare_frags</span><span class="p">(</span><span class="n">query_frag</span><span class="p">,</span> <span class="n">db_frag</span><span class="p">,</span> <span class="n">mtol</span><span class="p">,</span> <span class="n">ppm</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">intensity_product</span><span class="p">(</span><span class="n">query_int</span><span class="p">,</span> <span class="n">hits</span><span class="p">,</span> <span class="n">db_int</span> <span class="o">=</span> <span class="n">db_int</span><span class="p">)</span> <span class="o">==</span> <span class="mi">10</span><span class="o">*</span><span class="mi">10</span><span class="o">+</span><span class="mi">30</span><span class="o">*</span><span class="mi">20</span>
    
<span class="n">test_intensity_product</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="B-&amp;-Y---Hits">B &amp; Y - Hits<a class="anchor-link" href="#B-&amp;-Y---Hits">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="b_y_hits" class="doc_header"><code>b_y_hits</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L383" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>b_y_hits</code>(<strong><code>frag_type</code></strong>, <strong><code>hits</code></strong>)</p>
</blockquote>
<p>Count the number of b and y hits
hits usually start with b-ions (0), then y-ions (1)</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">test_b_y_hits</span><span class="p">():</span>
    <span class="c1"># TODO: Write a test to make sure the by hits are correct..</span>
    <span class="n">mtol</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">query_frag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">400</span><span class="p">])</span>
    <span class="n">db_frag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">700</span><span class="p">])</span>
    <span class="n">query_int</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">])</span>
    <span class="n">frag_type</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

    <span class="n">hits</span> <span class="o">=</span> <span class="n">compare_frags</span><span class="p">(</span><span class="n">query_frag</span><span class="p">,</span> <span class="n">db_frag</span><span class="p">,</span> <span class="n">mtol</span><span class="p">,</span> <span class="n">ppm</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">b_hit</span><span class="p">,</span> <span class="n">y_hit</span> <span class="o">=</span> <span class="n">b_y_hits</span><span class="p">(</span><span class="n">frag_type</span><span class="p">,</span> <span class="n">hits</span><span class="p">)</span>

    <span class="k">assert</span> <span class="p">(</span><span class="n">b_hit</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
    <span class="k">assert</span> <span class="p">(</span><span class="n">y_hit</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>

    <span class="n">frag_type</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

    <span class="n">hits</span> <span class="o">=</span> <span class="n">compare_frags</span><span class="p">(</span><span class="n">query_frag</span><span class="p">,</span> <span class="n">db_frag</span><span class="p">,</span> <span class="n">mtol</span><span class="p">,</span> <span class="n">ppm</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">b_hit</span><span class="p">,</span> <span class="n">y_hit</span> <span class="o">=</span> <span class="n">b_y_hits</span><span class="p">(</span><span class="n">frag_type</span><span class="p">,</span> <span class="n">hits</span><span class="p">)</span>

    <span class="k">assert</span> <span class="p">(</span><span class="n">b_hit</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
    <span class="k">assert</span> <span class="p">(</span><span class="n">y_hit</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>

    <span class="n">frag_type</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

    <span class="n">hits</span> <span class="o">=</span> <span class="n">compare_frags</span><span class="p">(</span><span class="n">query_frag</span><span class="p">,</span> <span class="n">db_frag</span><span class="p">,</span> <span class="n">mtol</span><span class="p">,</span> <span class="n">ppm</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">b_hit</span><span class="p">,</span> <span class="n">y_hit</span> <span class="o">=</span> <span class="n">b_y_hits</span><span class="p">(</span><span class="n">frag_type</span><span class="p">,</span> <span class="n">hits</span><span class="p">)</span>

    <span class="k">assert</span> <span class="p">(</span><span class="n">b_hit</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
    <span class="k">assert</span> <span class="p">(</span><span class="n">y_hit</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
    
<span class="n">test_b_y_hits</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="score_parallel" class="doc_header"><code>score_parallel</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L399" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>score_parallel</code>(<strong><code>psms</code></strong>, <strong><code>query_masses</code></strong>, <strong><code>query_frags</code></strong>, <strong><code>query_ints</code></strong>, <strong><code>db_masses</code></strong>, <strong><code>db_frags</code></strong>, <strong><code>frag_types</code></strong>, <strong><code>mtol</code></strong>, <strong><code>query_bounds</code></strong>, <strong><code>db_bounds</code></strong>, <strong><code>ppm</code></strong>, <strong><code>db_ints</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Extract values to calculate a score. Parallel version.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="score_single" class="doc_header"><code>score_single</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L468" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>score_single</code>(<strong><code>psms</code></strong>, <strong><code>query_masses</code></strong>, <strong><code>query_frags</code></strong>, <strong><code>query_ints</code></strong>, <strong><code>db_masses</code></strong>, <strong><code>db_frags</code></strong>, <strong><code>frag_types</code></strong>, <strong><code>mtol</code></strong>, <strong><code>query_bounds</code></strong>, <strong><code>db_bounds</code></strong>, <strong><code>ppm</code></strong>, <strong><code>db_ints</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Extract values to calculate a score. Single core version.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">### Extracting Score columns</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="add_column" class="doc_header"><code>add_column</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L538" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>add_column</code>(<strong><code>recarray</code></strong>, <strong><code>column</code></strong>, <strong><code>name</code></strong>)</p>
</blockquote>
<p>Function to add a column with given name to recarray</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="remove_column" class="doc_header"><code>remove_column</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L550" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>remove_column</code>(<strong><code>recarray</code></strong>, <strong><code>name</code></strong>)</p>
</blockquote>
<p>Function to remove a column from recarray</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_sequences" class="doc_header"><code>get_sequences</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L559" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_sequences</code>(<strong><code>psms</code></strong>, <strong><code>db_seqs</code></strong>)</p>
</blockquote>
<p>Get sequences to add them to a recarray</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_score_columns" class="doc_header"><code>get_score_columns</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L568" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_score_columns</code>(<strong><code>psms</code></strong>, <strong><code>query_data</code></strong>, <strong><code>db_data</code></strong>, <strong><code>features</code></strong>, <strong><code>parallel</code></strong>, <strong><code>m_tol</code></strong>, <strong><code>m_offset</code></strong>, <strong><code>ppm</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Plot">Plot<a class="anchor-link" href="#Plot">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="plot_hit" class="doc_header"><code>plot_hit</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L682" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>plot_hit</code>(<strong><code>df</code></strong>, <strong><code>index</code></strong>, <strong><code>db_bounds</code></strong>, <strong><code>db_frags</code></strong>, <strong><code>frag_types</code></strong>, <strong><code>query_bounds</code></strong>, <strong><code>query_frags</code></strong>, <strong><code>query_ints</code></strong>, <strong><code>ppm</code></strong>, <strong><code>m_tol</code></strong>, <strong><code>db_ints</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Wrapper">Wrapper<a class="anchor-link" href="#Wrapper">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="perform_search" class="doc_header"><code>perform_search</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L753" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>perform_search</code>(<strong><code>query_files</code></strong>, <strong><code>db_masses</code></strong>, <strong><code>db_frags</code></strong>, <strong><code>db_bounds</code></strong>, <strong><code>db_seqs</code></strong>, <strong><code>frag_types</code></strong>, <strong><code>plot</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Function to search and score one or multiple MS runs by the X!Tandem approach.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}
</div>
 

