---

title: Search

keywords: fastai
sidebar: home_sidebar

summary: "Functions related to the search"
description: "Functions related to the search"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs\05_search.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This notebook contains all functions related to the searching and getting peptide-spectrum-matches (PSMS).</p>
<p>Current ToDo here:</p>
<ul>
<li>Most of the functions are not very well described yet</li>
<li>A key ingredient of speed is the frag_hits matrix to store the results which should be described</li>
<li>Introductory text to give an overview would be nice.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Comparing-Fragments">Comparing Fragments<a class="anchor-link" href="#Comparing-Fragments"> </a></h2><p>To efficiently compare two fragments, we use a pointer based approach. We start with two sorted arrays, the <code>query_frag</code> that contains the m/z positions of the query spectrum and the <code>db_frag</code> which contains the database fragment that is compared against to. The two pointers compare each m/z position with each other and check wheter they are within a certain tolerance <code>mtol</code>. Depending on their delta, either of the pointers is advanced. The function returns an arrray named <code>hits</code> that is the same length as the database spectrum and encodes the hit positions.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="compare_frags" class="doc_header"><code>compare_frags</code><a href="__main__.py#L7" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>compare_frags</code>(<strong><code>query_frag</code></strong>, <strong><code>db_frag</code></strong>, <strong><code>mtol</code></strong>, <strong><code>ppm</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Compare query and database frags and find hits</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">query_frag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">400</span><span class="p">])</span>
<span class="n">db_frag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">150</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">450</span><span class="p">])</span>

<span class="c1"># Hits: Query 2 -&gt; Db 2 and Query 3 -&gt; Db 3</span>

<span class="n">compare_frags</span><span class="p">(</span><span class="n">query_frag</span><span class="p">,</span> <span class="n">db_frag</span><span class="p">,</span> <span class="n">mtol</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([0, 2, 3, 0], dtype=int16)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This function allows us to easily compare a query spectrum against a theoretical database.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">alphapept</span> <span class="kn">import</span> <span class="n">constants</span>
<span class="kn">from</span> <span class="nn">alphapept.fasta</span> <span class="kn">import</span> <span class="n">get_frag_dict</span><span class="p">,</span> <span class="n">parse</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">peptide</span> <span class="o">=</span> <span class="s1">&#39;PEPTIDE&#39;</span>

<span class="c1"># Theoretical Spectrum</span>

<span class="n">frag_dict</span> <span class="o">=</span> <span class="n">get_frag_dict</span><span class="p">(</span><span class="n">parse</span><span class="p">(</span><span class="n">peptide</span><span class="p">),</span> <span class="n">constants</span><span class="o">.</span><span class="n">mass_dict</span><span class="p">)</span>
<span class="n">db_frag</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">frag_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="n">db_frag</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

<span class="n">db_int</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">db_frag</span><span class="p">]</span>

<span class="c1"># Experimental Spectrum, dummy data</span>

<span class="n">query_frag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">98.06</span><span class="p">,</span> <span class="mf">227.10</span><span class="p">,</span> <span class="mf">263.08</span><span class="p">,</span> <span class="mf">548.06</span><span class="p">,</span> <span class="mf">653.31</span><span class="p">])</span>
<span class="n">query_int</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">])</span>

<span class="n">hits</span> <span class="o">=</span> <span class="n">compare_frags</span><span class="p">(</span><span class="n">query_frag</span><span class="p">,</span> <span class="n">db_frag</span><span class="p">,</span> <span class="n">mtol</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">hitpos</span> <span class="o">=</span> <span class="n">hits</span><span class="p">[</span><span class="n">hits</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">hit_x</span> <span class="o">=</span> <span class="n">query_frag</span><span class="p">[</span><span class="n">hitpos</span><span class="p">]</span>
<span class="n">hit_y</span> <span class="o">=</span> <span class="n">query_int</span><span class="p">[</span><span class="n">hitpos</span><span class="p">]</span>


<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">db_frag</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">db_int</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;DB&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">query_frag</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">query_int</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Query&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hit_x</span><span class="p">,</span> <span class="n">hit_y</span><span class="p">,</span> <span class="s2">&quot;ro&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Hit&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">frag_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">frag_dict</span><span class="p">[</span><span class="n">_</span><span class="p">],</span> <span class="mi">104</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Theoretical Spectrum for </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">peptide</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Mass&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Intensity&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">110</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>C:\ProgramData\Anaconda3\envs\alphap\lib\site-packages\numba\ir_utils.py:2041: NumbaPendingDeprecationWarning: <span class="ansi-bold">
Encountered the use of a type that is scheduled for deprecation: type &#39;reflected list&#39; found for argument &#39;db_frag&#39; of function &#39;compare_frags&#39;.

For more information visit http://numba.pydata.org/numba-doc/latest/reference/deprecation.html#deprecation-of-reflection-for-list-and-set-types
</span><span class="ansi-bold">
File &#34;&lt;ipython-input-2-cbbf95b3f48a&gt;&#34;, line 8:</span>
<span class="ansi-bold">@njit(nogil=True)
</span><span class="ansi-bold">def compare_frags(query_frag, db_frag, mtol, ppm=False):
</span><span class="ansi-bold">^</span>

  warnings.warn(NumbaPendingDeprecationWarning(msg, loc=loc))
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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1tIWz6Dw+uuvM2vWLN566y1qamrYcsst6d2799vWy0zmzZvHtGnT2H777Rv9/AayZjB8+HA+/vGP89WvfrXsUtaqrq6O448/nhdffJG//vWvZZdTmkWLFjFq1ChGjhxJTU0NF110Eeeddx6XXnppi263W7du/OAHP2Dw4ME8/fTTfOELX2Dbbbdl2LBhLbrdljBgwAAuvPBCBg4cSGZy88038/Wvf52bbrqp7NIadOSRR/Lv//7vdOvWjdmzZ3PGGWcwZMgQ9t1337JLe5tp06Zxzz33tPgfCM3lRz/6Edtvvz0rVqwou5SNdt9991FTU9Oq2/zkJz/J5z73uVbdZmt48803Vwtj6zNjxgwyk3e84x3U1NSsNrPWVixZsoRXXnllVahcvnz5Wt/3EcHmm2/OnDlzNmgb7T+Kt6KJEydyzDHH8KEPfYjzzjuPt956iy5duvDxj3+c4cOHt/o/5jVdf/31nHXWWauNXXTRRfzXf/0Xe+yxBwcccAADBjR4+pNNUkM/rz333JP999+fHj16UFtby8c+9jGefPLJZtneuvr/mc98hiFDhtCpUyd22WUX3vve9zJhwoRm2W5LaqiHvXr1YuuttyYiyEw6derEyy+/XGqd6+r9dtttt9rsR0Ssmt0rQ0M9Xemiiy7ii1/84gbt5mgp6+opwIQJE5gyZQqHH354GeU1ybp63xLW18NNWUNhrL6+nilTpvDss88yffp0VqxYwZIlS1i0aBEDBw6kc+fORMRq/15b09y5c9/2u2HmzJnMnDmTuXPn0qdPH3r27ElE0LlzZzbbbLO1Pldjw2g1A9kGuOOOO7jsssv47W9/y0svvcRVV11VdkmrOeSQQ3jooYdYtGgRAMuXL+fuu+/mkEMOKbmycjTm5/X444832662xvZ/yZIlTJw4sc3u4qu2rh7us88+jBw5ku9///ul7wJcX++vvfZa9t57bw455BDq6+s5+OCDS6t1bT3905/+ROfOndlrr71Kq63aunq6YsUKLrzwQs4666wm/cdTlnW9nw877DAOOeQQzjvvPF577bVm2d763pe33HIL++67LyeccAL33ntvs2yzLVuwYAGDBw/mne98J2+99RZz586lvr6eLl26MGfOHJ599lmmTJnCwoULN3pbPXv2XO3+tddeyxlnnAHAT3/6U66//vpV49OnTwcqe5IWL17M8uXLgcqux4ULF1JXV8cbb7wBwJQpU3juued45ZVXVq3XXAxkG+DYY49dtc/41FNP5Y9//GPZJa2mf//+7LbbbvzpT38C4KGHHqJPnz68+93vLrmycqzv5zV58mSuuuoqvvSlLzXL9hrb//PPP58dd9yRkSNHNst2W9K6enjfffdx//33c9ZZZ/Gud72rxCrX3/uTTz6ZBx54gBtuuIFDDz30bb+sW1NDPX3jjTe4/PLLGT16dGl1rWldPb3pppvYZZdd2t3vloZ636dPH66//npuv/12fvGLX/D666/zjW98o1m2t64eHnfccdx6663cfffdfPazn+Xcc89tttn6tqpfv3506dKFmpoa+vfvz8KFC1m2bBlLliyhpqaGoUOHstVWWzF9+nSWLFnSYnWcfvrpfPKTnwRWD2RdunShe/fuqwLh4sWLqampoVu3bixbtowFCxYwaNAg3vGOd5CZzJw5s1nrMpBtgC233HLV7YEDB27w/uHWcNhhh3HHHXcAlb8GO+rsGKz75/Xyyy/zxS9+kdGjR/Pe97632ba5vv5fcsklTJkyhQsuuKBdzCys7z3frVs3jj76aM455xxeffXV1i5vNevrfUTwrne9i65du/LTn/60jBKBhnt6xRVXcMghh7D11luXVldDGurpnDlzuOmmm/j85z9fcnUbrqHed+/enZ122omamhr69evHV7/6Vf7v//6P119/vVm2ubb35b/8y79QV1dHTU0Ne+21FwcffPAmP0vWufM/D1vv0qULS5cuJSKofe45+l92GZ1OO40e3/8+faZOZfHixS1Wx7nnnsvYsWO55ZZbePTRR/nEJz7B8OHDqa+vp66ujgULFgCVGb26ujqg8vujT58+dO3alZqaGjbffPNmr9FAtgFmzZq16vbMmTPb5PFY++yzD5MnT2bKlCn85S9/4cMf/nDZJZVmbT+vGTNm8LnPfY7TTjut2QPruvp/xRVX8D//8z9cfvnlDX7SqC1qzHs+M3nzzTdL/wOlse/95cuXl3oMWUM9/etf/8pNN93EgQceyIEHHsisWbMYM2YM1113XWl1QsM9nThxInPnzuWjH/0oBx54IGPHjmXixIkceOCBbf7g/sa8n1f+oZSZzbLNxr4vVx6TuSlbtmzZqttLly6lS5cudHv+efpdcw3Mnw+DBsH8+fQaN46aiRM3alv19fUMHz581eWcc8552zof/ehHGTFiBDfccANPPPEE3bp1o1evXixZsoQ333yTxYsXrwpktbW1G1VPY/gpyw1w8803s/fee1NbW8vPfvYzDjzwQIDVDgxdunTpqoP9y5gB2Wyzzdhvv/04++yz2Xnnndlqq62AyseKly1bxvLly8lM3nrrLTp16rTaXyybmoZ+XrNnz+b000/nmGOO4eijj272ba6t/9dccw133nknV1555ap/4O1BQz18+OGH6dOnD0OHDqW+vp4f//jH9O7de4M+3t0SGur9ihUr+M1vfsP+++9Pr169ePrpp7n55ps55ZRTSquzoZ6ecMIJq/1ndeKJJ3LmmWey5557llYnNNzTfv368bvf/W7VOnfddRd33nknF198cZs/ZUNDvX/qqafo1asX2267LYsWLeL73/8+u+++e7Pt1l7b74R77rmHkSNHUltbyyOPPMIdd9zBD37wg2bZZlv16quv0rNnTzp16sTcuXPp3bs33X7+c97q04c3unalewTLevZkSffu9L77bvjgB5u8rW7duvHEE0+sun/ttdc26ruvO3XqRK9evXjllVfo1q3bqg/Y9OnThzlz5lBXV0fnzp2ZN29esx/6sOn+b9wCDj74YD7/+c8zZ84c/u3f/o1TTz0VgKOPPpoZM2YArDpo8Lbbbitt98Nhhx3Gb37zm9X+Ivj973/Peeedt+r+nnvuyWGHHca5555bQoWto6Gf1/XXX88rr7zClVdeyZVXXrlq3b/85S/Ntt2G+n/55ZfTpUsXPvKRj6waO+WUU0o/GH59Gurhgw8+yEUXXcTs2bPp2rUrO+20E5deeuk6P3HUWhrq/Z///Gcuu+wyli5dyoABAzj22GM59thjS6uxoZ6u+dd3TU0NvXv3pnv37iVV+U9r9nSzzTZj8803X7W8Z8+edO7cebWxtqqh3t9///1cfvnlvPrqq/To0YP3v//9nH/++c263YbelzfeeCPf/va3yUy22WYbvvGNb7TJc1g2p7q6OqZOncqyZcvo2bMn/fv3J15+mZ7bbMOi11+nvr6eTp060WPgQDq/8kppdfbp04fXXntttfd0nz59WLp0Kf/4xz+Ayvt+ZbhuLtGep0hHjBiRjUm8Hc3MmTM5+uijueuuu9rNrrFNif0vj71vfvZ043W0Hk6aNKnxH/g499zK7sq+ff85tvL+RkwY9OzZc7VjvFbOkF122WWce+659OzZk9GjR3P44Ydz5pln8qEPfWjVukuXLmXKlCkMHTp0o05n1VAfIuKxzBzR0Ppte35ZG2zFihXccMMNHHTQQR3iH35bY//LY++bnz3dePZwPUaNqgSw+fNhxYp/3h41qlU2f/LJJ3P66aevOqh/5Vn2e/fu3ernFnWGbBNSX1/PgQceyMCBA7n00ktX+0SRWp79L4+9b372dON11B5u0AwZwIQJMH48TJ0KgwdXwlgJ32KyYsUKnnvuObp06cLgwYM3+gTNGzpDZiCTJEnNZoMD2SbKXZaSJEntjIFMkiSpZC0WyCLiZxExOyKeqhrrFxF3R8Tk4rpv1bKvRcTzEfFsRBzUUnVJkiS1NS05Q3YtsOY3+I4B7snMocA9xX0iYifgOGDn4jE/jojW/XiDJElSSVoskGXmA8CaX253JLDyu0CuA46qGr8pM5dk5j+A54E9Wqo2SZKktqS1jyHbMjNnABTXWxTj2wAvV603rRiTJEnaIDU1NQwfPpydd96Z97znPVx88cWrvmv1vvvuo66ujuHDhzNs2DD2339/Zs+eXXLFbeeg/oa+9LHB83FExKcj4tGIeLQ1vsz4ueee47nnnmvx7Wys9lJnSyurD5tS/9vba2kP9baHGldqT7U2hr8TyvXmm2/y5ptvtvp2V36X5cSJE7n77rv5wx/+sNrXB+6999488cQTTJgwgfe9731ccsklpdRZrbUD2ayIGAhQXK+MpNOAbavWGwRMb+gJMnNcZo7IzBEDBgxo0WIlSVL7tsUWWzBu3Dguu+wy1jz3amayaNEi+vTpU1J1/9TaXy5+G3AScEFx/duq8V9GxMXA1sBQ4JFWrk2SJG2CdthhB1asWLFq1+Rf/vIXhg8fzrx58+jRowcPPPBAyRW2YCCLiBuBfYD+ETEN+BaVIHZzRJwKTAWOAcjMiRFxM/A0sAz4fGYub6naJElS65g8eTJdu3Zttufbcccdm/S46tmxvffem9tvvx2ACy+8kLPPPptLL720WeprqhYLZJl5/FoW7beW9b8LfLel6pEkSR3TCy+8QE1NDVtssQWTJk1abdkRRxzBqFb6MvN1ae1dlpIkqQMZOnQotbW1pW1/zpw5nH766ZxxxhlEvP0zhA8++CA77LBDCZWtzkAmSZI2KfX19QwfPpylS5fSuXNnTjzxRM4888xVy1ceQ5aZ1NXVcfnll5dYbYWBTJIkbVKWL1/7Yej77LMPCxYsWG2s7FNeQNs5D5kkSVKHZSCTJEkqmYFMkiSpZAYySZKkkhnIJEmSSmYgkyRJKpmBTJIkbXKmTZvGkUceydChQ9lhhx0444wzWLJkSdllrZWBTJIkbVIyk1GjRnHUUUcxefJkJk+eTH19PWedddZGP/e6znG2MQxkkiRpk3LvvfdSW1vLKaecAkBNTQ0/+MEPuP7667nssss444wzVq172GGH8cADDwBw1113MXLkSHbbbTeOOeYYFi9eDMCQIUP49re/zb/+679ywQUXsNtuu616/OTJk9l99903umYDmSRJ2qRMnDjxbSGpd+/eDBkyhGXLljX4mLlz5/Kd73yHP/3pTzz++OOMGDGCiy++eNXy2tpaHnzwQc4++2zq6up44oknALjmmms4+eSTN7pmvzpJkiS1mJqf/xy6dGm+J2xE+MnMBr9IPDPX+phHHnmEp59+mr322guAt956i5EjR65afuyxx666fdppp3HNNddw8cUX86tf/YpHHnlkA15AwwxkkiRpk7Lzzjvz61//erWxhQsXMmvWLDbffHOee+65VeMrv8cyMznggAO48cYbG3zOHj16rLp99NFHc95557Hvvvuy++67s/nmm290zQYySZLUYpafeCJdamtbdZv77bcfY8aM4frrr+eTn/wky5cv5ytf+QpnnHEG22+/PT/5yU9YsWIFr7zyyqrZrT322IP/+I//4Pnnn+ed73wnb7zxBtOmTWPHHXd82/PX1tZy0EEH8dnPfparr766WWr2GDJJkrRJiQhuvfVWbrnlFoYOHcrmm29Op06dOPvss9lrr73Yfvvt2XXXXRk9evSqA/QHDBjAtddey/HHH8+wYcP4wAc+wDPPPLPWbXziE58gIjjwwAObpWZnyCRJ0iZn22235bbbbgPgoYce4vjjj+exxx5j991354Ybblht3ZW7Lffdd1/++te/vu25XnzxxbeNPfjgg3zqU5+ipqamWeo1kEmSpE3annvuyUsvvdRsz/eRj3yEKVOmcO+99zbbcxrIJEmSNsCtt97a7M/pMWSSJEklM5BJkqRmta7zfXUETXn9BjJJktRsamtrmTdvXocNZZnJvHnzqN3AU314DJkkSWo2gwYNYtq0acyZM4elS5cC0KU5z9Tf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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Comparing-Spectra">Comparing Spectra<a class="anchor-link" href="#Comparing-Spectra"> </a></h2><p>To compare multiple spectra against a database, we first need some helper functions. Per default, AlphaPept calculates in Dalton. To use ppm boundaries, we need the function <a href="/alphapept/search#ppm_to_dalton"><code>ppm_to_dalton</code></a> for conversion.</p>
<p>To minimize the search space, we typically only compare spectra with precursors in the same mass range as defined by <code>m_offset</code>. To look up the limits for search, we define the function <a href="/alphapept/search#get_idxs"><code>get_idxs</code></a>, which is a wrapper to the fast <code>searchsorted</code> method from NumPy.</p>
<p>The actual search takes place in <a href="/alphapept/search#compare_specs_single"><code>compare_specs_single</code></a> and <a href="/alphapept/search#compare_specs_parallel"><code>compare_specs_parallel</code></a>, a single-core and multicore method for comparing spectra.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ppm_to_dalton" class="doc_header"><code>ppm_to_dalton</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L49" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ppm_to_dalton</code>(<strong><code>mass</code></strong>, <strong><code>m_offset</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_idxs" class="doc_header"><code>get_idxs</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L57" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_idxs</code>(<strong><code>db_masses</code></strong>, <strong><code>query_masses</code></strong>, <strong><code>m_offset</code></strong>, <strong><code>ppm</code></strong>)</p>
</blockquote>
<p>Function to get upper and lower limits to define search range.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="compare_specs_parallel" class="doc_header"><code>compare_specs_parallel</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L72" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>compare_specs_parallel</code>(<strong><code>frag_hits</code></strong>, <strong><code>query_masses</code></strong>, <strong><code>query_frags</code></strong>, <strong><code>db_masses</code></strong>, <strong><code>db_frags</code></strong>, <strong><code>idxs_lower</code></strong>, <strong><code>idxs_higher</code></strong>, <strong><code>mtol</code></strong>, <strong><code>query_bounds</code></strong>, <strong><code>db_bounds</code></strong>, <strong><code>chunk</code></strong>=<em><code>(0, 1)</code></em>, <strong><code>offset</code></strong>=<em><code>False</code></em>, <strong><code>ppm</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Compare spectra, parallelized version</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="compare_specs_single" class="doc_header"><code>compare_specs_single</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L124" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>compare_specs_single</code>(<strong><code>frag_hits</code></strong>, <strong><code>query_masses</code></strong>, <strong><code>query_frags</code></strong>, <strong><code>db_masses</code></strong>, <strong><code>db_frags</code></strong>, <strong><code>idxs_lower</code></strong>, <strong><code>idxs_higher</code></strong>, <strong><code>mtol</code></strong>, <strong><code>query_bounds</code></strong>, <strong><code>db_bounds</code></strong>, <strong><code>chunk</code></strong>=<em><code>(0, 1)</code></em>, <strong><code>offset</code></strong>=<em><code>False</code></em>, <strong><code>ppm</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Compare spectra, single core version</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Wrapper">Wrapper<a class="anchor-link" href="#Wrapper"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="query_data_to_features" class="doc_header"><code>query_data_to_features</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L183" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>query_data_to_features</code>(<strong><code>query_data</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="log_me.<locals>.wrapper" class="doc_header"><code>log_me.<locals>.wrapper</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/utils.py#L12" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>log_me.<locals>.wrapper</code>(<strong>*<code>args</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Extracting-columns-for-scoring">Extracting columns for scoring<a class="anchor-link" href="#Extracting-columns-for-scoring"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Frag-Delta">Frag Delta<a class="anchor-link" href="#Frag-Delta"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="frag_delta" class="doc_header"><code>frag_delta</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L351" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>frag_delta</code>(<strong><code>query_frag</code></strong>, <strong><code>db_frag</code></strong>, <strong><code>hits</code></strong>)</p>
</blockquote>
<p>Calculate the mass difference for a given array of hits in Dalton and ppm</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Intensity-Fraction">Intensity Fraction<a class="anchor-link" href="#Intensity-Fraction"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="intensity_fraction" class="doc_header"><code>intensity_fraction</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L365" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>intensity_fraction</code>(<strong><code>query_int</code></strong>, <strong><code>hits</code></strong>)</p>
</blockquote>
<p>Calculate the fraction of matched intensity</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Intensity-Product">Intensity Product<a class="anchor-link" href="#Intensity-Product"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="intensity_product" class="doc_header"><code>intensity_product</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L380" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>intensity_product</code>(<strong><code>query_int</code></strong>, <strong><code>hits</code></strong>, <strong><code>db_int</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Calculate the dot product of matched query intensity to db intensity</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Mass-desnity-scores">Mass desnity scores<a class="anchor-link" href="#Mass-desnity-scores"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following functions are used to calculate scores that take the relative abundance of fragment ion masses in the database into account. The underlying hypothesis is that matched ions in less populated m/z regions are worth more that ions matched in highly populated m/z regions.</p>
<p>The <a href="/alphapept/search#get_frag_mass_density_norm"><code>get_frag_mass_density_norm</code></a> takes fragment ion masses <code>frags</code> as input and creates both an array of m/z bins and the respective negaive m/z density values. The <code>mz_factor</code> determines the m/z bin-width. A factor of 0.5 results in m/z bins of 20 Da, while a factor of 10 results in m/z bins of 0.1 Da.</p>
<p>The score calculated by <a href="/alphapept/search#mass_density_weighted_fragment_sum"><code>mass_density_weighted_fragment_sum</code></a> corresponds to the sum of fragment ion hits weighted by the negative mass density. A fragment ion match in a sparsely populated m/z region therefor counts nearly 1, while a match in a densely populated region contributes with a low weight, e.g. 0.1.</p>
<p>The score calculated by <a href="/alphapept/search#mass_density_weighted_intensity_sum"><code>mass_density_weighted_intensity_sum</code></a> corresponds to a matched intensity score weighted by the negative mass density.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_frag_mass_density_norm" class="doc_header"><code>get_frag_mass_density_norm</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L396" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_frag_mass_density_norm</code>(<strong><code>frags</code></strong>, <strong><code>mz_factor</code></strong>=<em><code>0.05</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="mass_density_weighted_fragment_sum" class="doc_header"><code>mass_density_weighted_fragment_sum</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L430" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>mass_density_weighted_fragment_sum</code>(<strong><code>query_frag</code></strong>, <strong><code>hits</code></strong>, <strong><code>mz_space</code></strong>, <strong><code>mz_density</code></strong>, <strong><code>mz_factor</code></strong>=<em><code>0.05</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="mass_density_weighted_intensity_sum" class="doc_header"><code>mass_density_weighted_intensity_sum</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L440" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>mass_density_weighted_intensity_sum</code>(<strong><code>query_int</code></strong>, <strong><code>query_frag</code></strong>, <strong><code>hits</code></strong>, <strong><code>mz_space</code></strong>, <strong><code>mz_density</code></strong>, <strong><code>mz_factor</code></strong>=<em><code>0.05</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="B-&amp;-Y---Hits">B &amp; Y - Hits<a class="anchor-link" href="#B-&amp;-Y---Hits"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="b_y_hits" class="doc_header"><code>b_y_hits</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L463" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>b_y_hits</code>(<strong><code>frag_type</code></strong>, <strong><code>hits</code></strong>)</p>
</blockquote>
<p>Count the number of b and y hits
hits usually start with b-ions (0), then y-ions (1)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="score_parallel" class="doc_header"><code>score_parallel</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L479" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>score_parallel</code>(<strong><code>psms</code></strong>, <strong><code>query_masses</code></strong>, <strong><code>query_frags</code></strong>, <strong><code>query_ints</code></strong>, <strong><code>db_masses</code></strong>, <strong><code>db_frags</code></strong>, <strong><code>frag_types</code></strong>, <strong><code>mtol</code></strong>, <strong><code>query_bounds</code></strong>, <strong><code>db_bounds</code></strong>, <strong><code>ppm</code></strong>, <strong><code>db_ints</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Extract values to calculate a score. Parallel version.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="score_single" class="doc_header"><code>score_single</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L566" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>score_single</code>(<strong><code>psms</code></strong>, <strong><code>query_masses</code></strong>, <strong><code>query_frags</code></strong>, <strong><code>query_ints</code></strong>, <strong><code>db_masses</code></strong>, <strong><code>db_frags</code></strong>, <strong><code>frag_types</code></strong>, <strong><code>mtol</code></strong>, <strong><code>query_bounds</code></strong>, <strong><code>db_bounds</code></strong>, <strong><code>ppm</code></strong>, <strong><code>db_ints</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Extract values to calculate a score. Single core version.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">### Extracting Score columns</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="add_column" class="doc_header"><code>add_column</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L653" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>add_column</code>(<strong><code>recarray</code></strong>, <strong><code>column</code></strong>, <strong><code>name</code></strong>)</p>
</blockquote>
<p>Function to add a column with given name to recarray</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="remove_column" class="doc_header"><code>remove_column</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L665" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>remove_column</code>(<strong><code>recarray</code></strong>, <strong><code>name</code></strong>)</p>
</blockquote>
<p>Function to remove a column from recarray</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Reporting">Reporting<a class="anchor-link" href="#Reporting"> </a></h2><p>When performing a database search, we need to know what experimental spectrum we are comparing with which database entry. 
We distinguish three indices:</p>
<ul>
<li>query_idx</li>
<li>raw_idx</li>
<li>feature_idx
Initially, the get_psms functions accepts experimental data in the form of <code>query_data</code>. Here, the <code>query_idx</code> refers to the index to <code>query_data</code>. However, this might not be the same index as of the raw data. This is due to the implementation of the matching of MS1-features to MS2 spectra. Here we allow multiple matches and implement this by repeating the respective spectra. </li>
</ul>
<p>We then add the two columns <code>feature_idx</code> and <code>raw_idx</code> to the psms to later be able to distinguish where the match originated from. Here, <code>raw_idx</code> refers to the original spectrum.</p>
<p>When not applying feature finding, <code>raw_idx</code> and <code>query_idx</code> are equivalent.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_sequences" class="doc_header"><code>get_sequences</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L674" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_sequences</code>(<strong><code>psms</code></strong>, <strong><code>db_seqs</code></strong>)</p>
</blockquote>
<p>Get sequences to add them to a recarray</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_score_columns" class="doc_header"><code>get_score_columns</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L683" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_score_columns</code>(<strong><code>psms</code></strong>, <strong><code>query_data</code></strong>, <strong><code>db_data</code></strong>, <strong><code>features</code></strong>, <strong><code>parallel</code></strong>, <strong><code>m_tol</code></strong>, <strong><code>m_offset</code></strong>, <strong><code>ppm</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Plot">Plot<a class="anchor-link" href="#Plot"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="plot_hit" class="doc_header"><code>plot_hit</code><a href="__main__.py#L3" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>plot_hit</code>(<strong><code>df</code></strong>, <strong><code>index</code></strong>, <strong><code>db_bounds</code></strong>, <strong><code>db_frags</code></strong>, <strong><code>frag_types</code></strong>, <strong><code>query_bounds</code></strong>, <strong><code>query_frags</code></strong>, <strong><code>query_ints</code></strong>, <strong><code>ppm</code></strong>, <strong><code>m_tol</code></strong>, <strong><code>db_ints</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="plot_psms" class="doc_header"><code>plot_psms</code><a href="__main__.py#L76" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>plot_psms</code>(<strong><code>query_data</code></strong>, <strong><code>df</code></strong>, <strong><code>index</code></strong>, <strong><code>mass_dict</code></strong>, <strong><code>ppm</code></strong>=<em><code>True</code></em>, <strong><code>m_tol</code></strong>=<em><code>20</code></em>)</p>
</blockquote>
<p>Plot a psms</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Wrapper">Wrapper<a class="anchor-link" href="#Wrapper"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="perform_search" class="doc_header"><code>perform_search</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L958" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>perform_search</code>(<strong><code>query_files</code></strong>, <strong><code>db_masses</code></strong>, <strong><code>db_frags</code></strong>, <strong><code>db_bounds</code></strong>, <strong><code>db_seqs</code></strong>, <strong><code>frag_types</code></strong>, <strong><code>plot</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Function to search and score one or multiple MS runs by the X!Tandem approach.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Searching-with-database">Searching with database<a class="anchor-link" href="#Searching-with-database"> </a></h2><p>We save intermediate results to hdf5 files</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="store_hdf" class="doc_header"><code>store_hdf</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L984" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>store_hdf</code>(<strong><code>df</code></strong>, <strong><code>path</code></strong>, <strong><code>key</code></strong>, <strong><code>replace</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Stores in hdf</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="search_db" class="doc_header"><code>search_db</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L998" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>search_db</code>(<strong><code>to_process</code></strong>)</p>
</blockquote>
<p>Perform a databse search. One file at a time.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="search_parallel_db" class="doc_header"><code>search_parallel_db</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L1034" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>search_parallel_db</code>(<strong><code>settings</code></strong>, <strong><code>calibration</code></strong>=<em><code>None</code></em>, <strong><code>callback</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Function to generate a database from a fasta file</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Searching-Large-Fasta-and-or-Search-Space">Searching Large Fasta and or Search Space<a class="anchor-link" href="#Searching-Large-Fasta-and-or-Search-Space"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="search_fasta_block" class="doc_header"><code>search_fasta_block</code><a href="__main__.py#L8" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>search_fasta_block</code>(<strong><code>to_process</code></strong>)</p>
</blockquote>
<p>Search fasta block
For searches with big fasta files or unspecific searches</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="search_parallel" class="doc_header"><code>search_parallel</code><a href="__main__.py#L81" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>search_parallel</code>(<strong><code>settings</code></strong>, <strong><code>calibration</code></strong>=<em><code>None</code></em>, <strong><code>callback</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Function to generate a database from a fasta file</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

