---

title: Search


keywords: fastai
sidebar: home_sidebar

summary: "Functions related to the search"
description: "Functions related to the search"
nb_path: "nbs/05_search.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/05_search.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This notebook contains all functions related to searching and getting peptide-spectrum-matches (PSMs). When searching, we compare how similar an experimental spectrum is to a theoretical spectrum. As described in the FASTA notebook, we can calculate theoretical fragment masses for a given peptide sequence and get theoretical spectra. Typically, we calculate a database with all possible spectra, save it to disk, and then compare our experimental data. This allows re-using the database and saving time for this computational step. It could be that the database is too large to be saved on disc; in this case, generate the database on the fly, referring to only have a subset of all FASTA entries in memory and processing them.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Comparing-spectra">Comparing spectra<a class="anchor-link" href="#Comparing-spectra"> </a></h2><p>To efficiently compare two spectra, we use a pointer based approach. We start with two sorted arrays, the <code>query_frag</code> that contains the m/z positions of the experimental query spectrum and the <code>db_frag</code> which contains the database fragment that is compared against to. The two pointers compare each m/z position with each other and check wheter they are within a certain tolerance <code>frag_tol</code>. Depending on their delta, either of the pointers is advanced. The function returns an arrray named <code>hits</code> that is the same length as the database spectrum and encodes the hit positions.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="compare_frags" class="doc_header"><code>compare_frags</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L13" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>compare_frags</code>(<strong><code>query_frag</code></strong>:<code>ndarray</code>, <strong><code>db_frag</code></strong>:<code>ndarray</code>, <strong><code>frag_tol</code></strong>:<code>float</code>, <strong><code>ppm</code></strong>:<code>bool</code>=<em><code>False</code></em>)</p>
</blockquote>
<p>Compare query and database frags and find hits</p>
<p>Args:
    query_frag (np.ndarray): Array with query fragments.
    db_frag (np.ndarray): Array with database fragments.
    frag_tol (float): Fragment tolerance for search.
    ppm (bool, optional): Use ppm as unit or Dalton. Defaults to False.</p>
<p>Returns:
    np.ndarray: Array with reported hits.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">query_frag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">400</span><span class="p">])</span>
<span class="n">db_frag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">150</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">450</span><span class="p">])</span>

<span class="c1"># Hits: Query 2 -&gt; Db 2 and Query 3 -&gt; Db 3</span>

<span class="n">compare_frags</span><span class="p">(</span><span class="n">query_frag</span><span class="p">,</span> <span class="n">db_frag</span><span class="p">,</span> <span class="n">frag_tol</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([0, 2, 3, 0], dtype=int16)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This function allows us to easily compare a query spectrum against a spectrum from a theoretical database.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">alphapept</span> <span class="kn">import</span> <span class="n">constants</span>
<span class="kn">from</span> <span class="nn">alphapept.fasta</span> <span class="kn">import</span> <span class="n">get_frag_dict</span><span class="p">,</span> <span class="n">parse</span>
<span class="kn">import</span> <span class="nn">alphapept.io</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">peptide</span> <span class="o">=</span> <span class="s1">&#39;PEPTIDE&#39;</span>

<span class="c1"># Theoretical Spectrum</span>

<span class="n">frag_dict</span> <span class="o">=</span> <span class="n">get_frag_dict</span><span class="p">(</span><span class="n">parse</span><span class="p">(</span><span class="n">peptide</span><span class="p">),</span> <span class="n">constants</span><span class="o">.</span><span class="n">mass_dict</span><span class="p">)</span>
<span class="n">db_frag</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">frag_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="n">db_frag</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

<span class="n">db_int</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">db_frag</span><span class="p">]</span>

<span class="c1"># Experimental Spectrum, dummy data</span>

<span class="n">query_frag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">98.06</span><span class="p">,</span> <span class="mf">227.10</span><span class="p">,</span> <span class="mf">263.08</span><span class="p">,</span> <span class="mf">548.06</span><span class="p">,</span> <span class="mf">653.31</span><span class="p">])</span>
<span class="n">query_int</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">])</span>

<span class="n">hits</span> <span class="o">=</span> <span class="n">compare_frags</span><span class="p">(</span><span class="n">query_frag</span><span class="p">,</span> <span class="n">db_frag</span><span class="p">,</span> <span class="n">frag_tol</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">hitpos</span> <span class="o">=</span> <span class="n">hits</span><span class="p">[</span><span class="n">hits</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">hit_x</span> <span class="o">=</span> <span class="n">query_frag</span><span class="p">[</span><span class="n">hitpos</span><span class="p">]</span>
<span class="n">hit_y</span> <span class="o">=</span> <span class="n">query_int</span><span class="p">[</span><span class="n">hitpos</span><span class="p">]</span>


<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">db_frag</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">db_int</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;DB&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">query_frag</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">query_int</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Query&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hit_x</span><span class="p">,</span> <span class="n">hit_y</span><span class="p">,</span> <span class="s2">&quot;ro&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Hit&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">frag_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">frag_dict</span><span class="p">[</span><span class="n">_</span><span class="p">],</span> <span class="mi">104</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Theoretical Spectrum for </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">peptide</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Mass&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Intensity&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">110</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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f7Fsbxp6vxYuXMhZZ53F8ccfz7HHHlvyfW6u/2+++Wbuv/9+brzxxvpf8PagoT58+umnqa6uZsiQIdTU1PDTn/6Unj17Nunr3S2hob6vra3lV7/6FYcddhg9evTghRde4M477+S0007Lrc6G+vRLX/rSBv9ZnXzyyZx77rkccMABudUJDfdp7969+b//+7/6dR544AHuv/9+Lr/88jZ/yoaG+v7555+nR48e7LrrrqxYsYLLLruM/fbbr2SHtTf3b8LDDz/MyJEjqays5JlnnuG+++7jiiuuKMk+26q3336b7t27U1ZWxuLFi+nZsyddfv5z1lRX817nznSNYF337qzu2pWeDz4In/zkNu+rS5cuTJs2rf7xLbfc0qhrX5eVldGjRw/mzp1Lly5d6r9gU11dzaJFi6iqqqJTp04sWbKk5FMftt//jVvA4Ycfztlnn82iRYv41Kc+xemnnw7Asccey/z58wHqJw3ec889uR1+GD16NL/61a82+IvgN7/5DRdffHH94wMOOIDRo0czfvz4HCpsHQ29X5MnT2bu3LlMmjRpg3OxPfHEEyXbb0P9f80111BRUcExxxxT33baaaflPhl+axrqwyeffJIf/ehHLFy4kM6dO7PPPvtw9dVXb/EbR62lob7//e9/z8SJE1m7di39+vXjhBNO4IQTTsitxob6dOO/vsvLy+nZsyddu3bNqcr3bdynO+ywA3369Klf3r17dzp16rRBW1vVUN8/9thjXHPNNbz99tt069aNj3/84/zwhz8s6X4b+lzefvvt/OAHPyClxC677ML3vve9NnkOy1KqqqrijTfeYN26dXTv3p2+ffsSb75J9112YcW771JTU0NZWRnd+ven09y5udVZXV3NO++8s8Fnurq6mrVr1/L3v/8dKHzu68J1qUR7HiIdMWJEakzi7WgWLFjAscceywMPPNBuDo1tT+z//Nj3pWefNl9H68OZM2c2/gsf48cXDlf26vV+W93jZgwYdO/efYM5XnUjZBMnTmT8+PF0796dcePGceSRR3Luuefy6U9/un7dtWvXMnv2bIYMGdKs01k11A8R8WxKaURD67ft8WU1WW1tLbfddhuf+cxnOsQvfltj/+fHvi89+7T57MOtGDOmEMCWLoXa2vfvjxnTKrs/9dRTOeuss+on9dedZb9nz56tfm5RR8i2IzU1NYwa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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Comparing-Spectra">Comparing Spectra<a class="anchor-link" href="#Comparing-Spectra"> </a></h2><p>To compare multiple spectra against a database, we first need some helper functions. First, we need a conversion function to convert from Dalton masses to ppm, which is implemented in the <a href="/search.html#ppm_to_dalton"><code>ppm_to_dalton</code></a> function.</p>
<p>To minimize the search space, we typically only compare spectra with precursors in the same mass range as defined by <code>prec_tol</code>. To look up the limits for search, we define the function <a href="/search.html#get_idxs"><code>get_idxs</code></a>, which is a wrapper to the fast <code>searchsorted</code> method from <code>NumPy</code>.</p>
<p>The actual search takes place in <a href="/search.html#compare_spectrum_parallel"><code>compare_spectrum_parallel</code></a>, which utilizes the performance decorator from the performance notebook. Here we save the top matching spectra for each query spectrum. Note that for code compilation reasons, the code of the previously defined function <a href="/search.html#compare_frags"><code>compare_frags</code></a> is duplicated in here.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ppm_to_dalton" class="doc_header"><code>ppm_to_dalton</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L54" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ppm_to_dalton</code>(<strong><code>mass</code></strong>:<code>float</code>, <strong><code>prec_tol</code></strong>:<code>int</code>)</p>
</blockquote>
<p>Function to convert ppm tolerances to Dalton.</p>
<p>Args:
    mass (float): Base mass.
    prec_tol (int): Tolerance.</p>
<p>Returns:
    float: Tolerance in Dalton.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_idxs" class="doc_header"><code>get_idxs</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L69" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_idxs</code>(<strong><code>db_masses</code></strong>:<code>ndarray</code>, <strong><code>query_masses</code></strong>:<code>ndarray</code>, <strong><code>prec_tol</code></strong>:<code>float</code>, <strong><code>ppm</code></strong>:<code>bool</code>)</p>
</blockquote>
<p>Function to get upper and lower limits to define search range for a given precursor tolerance.</p>
<p>Args:
    db_masses (np.ndarray): Array containing database masses.
    query_masses (np.ndarray): Array containing query masses.
    prec_tol (float): Precursor tolerance for search.
    ppm: Flag to use ppm instead of Dalton.</p>
<p>Returns:
    (np.ndarray, np.ndarray): Indices to lower and upper bounds.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="compare_spectrum_parallel" class="doc_header"><code>compare_spectrum_parallel</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L96" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>compare_spectrum_parallel</code>(<strong><code>query_idx</code></strong>:<code>int</code>, <strong><code>query_masses</code></strong>:<code>ndarray</code>, <strong><code>idxs_lower</code></strong>:<code>ndarray</code>, <strong><code>idxs_higher</code></strong>:<code>ndarray</code>, <strong><code>query_indices</code></strong>:<code>ndarray</code>, <strong><code>query_frags</code></strong>:<code>ndarray</code>, <strong><code>query_ints</code></strong>:<code>ndarray</code>, <strong><code>db_indices</code></strong>:<code>ndarray</code>, <strong><code>db_frags</code></strong>:<code>ndarray</code>, <strong><code>best_hits</code></strong>:<code>ndarray</code>, <strong><code>score</code></strong>:<code>ndarray</code>, <strong><code>frag_tol</code></strong>:<code>float</code>, <strong><code>ppm</code></strong>:<code>bool</code>)</p>
</blockquote>
<p>Compares a spectrum and writes to the best_hits and score.</p>
<p>Args:
    query_idx (int): Integer to the query_spectrum that should be compared.
    query_masses (np.ndarray): Array with query masses.
    idxs_lower (np.ndarray): Array with indices for lower search boundary.
    idxs_higher (np.ndarray): Array with indices for upper search boundary.
    query_indices (np.ndarray): Array with indices to the query data.
    query_frags (np.ndarray): Array with frag types of the query data.
    query_ints (np.ndarray): Array with fragment intensities from the query.
    db_indices (np.ndarray):  Array with indices to the database data.
    db_frags (np.ndarray): Array with frag types of the db data.
    best_hits (np.ndarray): Reporting array which stores indices to the best hits.
    score (np.ndarray): Reporting array that stores the scores of the best hits.
    frag_tol (float): Fragment tolerance for search.
    ppm (bool): Flag to use ppm instead of Dalton.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Wrapper">Wrapper<a class="anchor-link" href="#Wrapper"> </a></h2><p>To conveniently perform peptide-spectrum matches on multiple datasets we define a wrapper <a href="/search.html#get_psms"><code>get_psms</code></a> that returns the PSMS when handing over <code>query_data</code> and <code>db_data</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="query_data_to_features" class="doc_header"><code>query_data_to_features</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L194" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>query_data_to_features</code>(<strong><code>query_data</code></strong>:<code>dict</code>)</p>
</blockquote>
<p>Helper function to extract features from query data.
This is used when the feature finder will not be used.</p>
<p>Args:
    query_data (dict): Data structure containing the query data.</p>
<p>Returns:
    pd.DataFrame: Pandas dataframe so that it can be used for subsequent processing.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_psms" class="doc_header"><code>get_psms</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L221" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_psms</code>(<strong><code>query_data</code></strong>:<code>dict</code>, <strong><code>db_data</code></strong>:<code>dict</code>, <strong><code>features</code></strong>:<code>DataFrame</code>, <strong><code>parallel</code></strong>:<code>bool</code>, <strong><code>frag_tol</code></strong>:<code>float</code>, <strong><code>prec_tol</code></strong>:<code>float</code>, <strong><code>ppm</code></strong>:<code>bool</code>, <strong><code>min_frag_hits</code></strong>:<code>int</code>, <strong><code>callback</code></strong>:<code>Callable</code>=<em><code>None</code></em>, <strong><code>m_offset_calibrated</code></strong>:<code>float</code>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>[summary]</p>
<p>Args:
    query_data (dict): Data structure containing the query data.
    db_data (dict): Data structure containing the database data.
    features (pd.DataFrame): Pandas dataframe containing feature data.
    parallel (bool): Flag to use parallel processing.
    frag_tol (float): Fragment tolerance for search.
    prec_tol (float): Precursor tolerance for search.
    ppm (bool): Flag to use ppm instead of Dalton.
    min_frag_hits (int): Minimum number of frag hits to report a PSMs.
    callback (Callable, optional): Optional callback. Defaults to None.
    m_offset_calibrated (float, optional): Precursor tolerance if calibration exists. Defaults to None.</p>
<p>Returns:
    np.ndarray: Numpy recordarray storing the PSMs.
    int: 0</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Extracting-columns-for-scoring">Extracting columns for scoring<a class="anchor-link" href="#Extracting-columns-for-scoring"> </a></h2><p>The basic fragment comparison only counts the number of hits and matched intensity fraction when comparing a theoretical spectrum to an experimental one. Based on this metric, we can drastically reduce the number of candidates one wants to analyze for an in-depth comparison, which requires additional features. The following section describes several functions which extract parameters to compare spectrum matches better.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Frag-Delta">Frag Delta<a class="anchor-link" href="#Frag-Delta"> </a></h3><p><a href="/search.html#frag_delta"><code>frag_delta</code></a> substracts the experimental fragment masses from the theoretical fragment masses for each hit.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="frag_delta" class="doc_header"><code>frag_delta</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L355" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>frag_delta</code>(<strong><code>query_frag</code></strong>:<code>ndarray</code>, <strong><code>db_frag</code></strong>:<code>ndarray</code>, <strong><code>hits</code></strong>:<code>ndarray</code>)</p>
</blockquote>
<p>Calculates the mass difference for a given array of hits in Dalton and ppm.</p>
<p>Args:
    query_frag (np.ndarray): Array with query fragments.
    db_frag (np.ndarray): Array with database fragments.
    hits (np.ndarray): Array with reported hits.</p>
<p>Returns:
    float: Fragment deltas in Dalton.
    float: Fragment deltas in ppm.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Intensity-Fraction">Intensity Fraction<a class="anchor-link" href="#Intensity-Fraction"> </a></h3><p><a href="/search.html#intensity_fraction"><code>intensity_fraction</code></a> calculates the fraction of matched intensity. This refers to the intensity of all hits compared to the intensity of all peaks in the query spectrum.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="intensity_fraction" class="doc_header"><code>intensity_fraction</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L376" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>intensity_fraction</code>(<strong><code>query_int</code></strong>:<code>ndarray</code>, <strong><code>hits</code></strong>:<code>ndarray</code>)</p>
</blockquote>
<p>Calculate the fraction of matched intensity</p>
<p>Args:
    query_int (np.ndarray): Array with query intensities.
    hits (np.ndarray): Array with reported hits.</p>
<p>Returns:
    float: Fraction of the matched intensity to the total intensity.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="File-Format">File Format<a class="anchor-link" href="#File-Format"> </a></h3><p>To have an efficient data format to store PSMs in the search. We use <code>numpy</code>-recarrays and define the utility functions <a href="/search.html#add_column"><code>add_column</code></a> and <a href="/search.html#remove_column"><code>remove_column</code></a> to append and remove data.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="add_column" class="doc_header"><code>add_column</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L401" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>add_column</code>(<strong><code>recarray</code></strong>:<code>ndarray</code>, <strong><code>column</code></strong>:<code>ndarray</code>, <strong><code>name</code></strong>:<code>str</code>)</p>
</blockquote>
<p>Function to add a column with given name to recarray</p>
<p>Args:
    recarray (np.ndarray): NumPy record array.
    column (np.ndarray): Data column that should be added to the record array.
    name (str): Name of the column in the new recordarray.</p>
<p>Returns:
    np.ndarray: NumPy recordarray with new field.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="remove_column" class="doc_header"><code>remove_column</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L420" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>remove_column</code>(<strong><code>recarray</code></strong>:<code>ndarray</code>, <strong><code>name</code></strong>:<code>str</code>)</p>
</blockquote>
<p>Function to remove a column from a recarray.</p>
<p>Args:
    recarray (np.ndarray): NumPy record array.
    name (str): Column name of the column to be removed.</p>
<p>Returns:
    np.ndarray: NumPy record array with removed column.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Extracting-features-for-scoring">Extracting features for scoring<a class="anchor-link" href="#Extracting-features-for-scoring"> </a></h2><h3 id="Indices">Indices<a class="anchor-link" href="#Indices"> </a></h3><p>When performing a database search, we need to know which experimental spectrum we compare with what database entry. 
We distinguish three indices:</p>
<ul>
<li>query_idx</li>
<li>raw_idx</li>
<li>feature_idx</li>
</ul>
<p>Initially, the get_psms function accepts experimental data in the form of <code>query_data</code>. Here, the <code>query_idx</code> refers to the index to <code>query_data</code>. However, this might not be the same index as the raw data. This is due to the implementation of the matching of MS1-features to MS2 spectra. Here we allow multiple matches and implement this by repeating the respective spectrum.</p>
<p>We then add the two columns <code>feature_idx</code> and <code>raw_idx</code> to the PSMs to later be able to distinguish where the match originated. In this case, <code>raw_idx</code> refers to the original spectrum.</p>
<p>When not applying feature finding, <code>raw_idx</code> and <code>query_idx</code> are equivalent.</p>
<h3 id="Features">Features<a class="anchor-link" href="#Features"> </a></h3><p>In the <a href="/score.html"><code>score</code></a>-function we use the pre-filtered PSMs to extract additional columns for scoring such as the offset from theoretical to experimental precursor or the number of b- and y-ion hits.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_hits" class="doc_header"><code>get_hits</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L436" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_hits</code>(<strong><code>query_frag</code></strong>:<code>ndarray</code>, <strong><code>query_int</code></strong>:<code>ndarray</code>, <strong><code>db_frag</code></strong>:<code>ndarray</code>, <strong><code>db_int</code></strong>:<code>ndarray</code>, <strong><code>frag_type</code></strong>:<code>ndarray</code>, <strong><code>mtol</code></strong>:<code>float</code>, <strong><code>ppm</code></strong>:<code>bool</code>, <strong><code>losses</code></strong>:<code>list</code>)</p>
</blockquote>
<p>Function to extract the types of hits based on a single PSMs.</p>
<p>The reporting array stores information about the matched ions column wise:</p>
<p>Column 0: Type of the ion.
Column 1: Ion-index refering to what ion type was matched.
Column 2: Intensity of the matched ion.
Column 3: Intensity of the database ion.
Column 4: Experimental mass of the ion.
Column 5: Theoretical mass of the ion.
Column 6: Index to the query_frag of the ion.
Column 7: Index to the database_frag of the ion.</p>
<p>Args:
    query_frag (np.ndarray): Array with query fragments.
    query_int (np.ndarray): Array with query intensities.
    db_frag (np.ndarray): Array with database fragments.
    db_int (np.ndarray): Array with database intensities.
    frag_type (np.ndarray): Array with fragment types.
    mtol (float): Mass tolerance.
    ppm (bool): Flag to use ppm instead of Dalton.
    losses (list): List of losses.</p>
<p>Returns:
    np.ndarray: NumPy array that stores ion information.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="score" class="doc_header"><code>score</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L502" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>score</code>(<strong><code>psms</code></strong>:<code>recarray</code>, <strong><code>query_masses</code></strong>:<code>ndarray</code>, <strong><code>query_masses_raw</code></strong>:<code>ndarray</code>, <strong><code>query_frags</code></strong>:<code>ndarray</code>, <strong><code>query_ints</code></strong>:<code>ndarray</code>, <strong><code>query_indices</code></strong>:<code>ndarray</code>, <strong><code>db_masses</code></strong>:<code>ndarray</code>, <strong><code>db_frags</code></strong>:<code>ndarray</code>, <strong><code>frag_types</code></strong>:<code>ndarray</code>, <strong><code>mtol</code></strong>:<code>float</code>, <strong><code>db_indices</code></strong>:<code>ndarray</code>, <strong><code>ppm</code></strong>:<code>bool</code>, <strong><code>psms_dtype</code></strong>:<code>list</code>, <strong><code>db_ints</code></strong>:<code>ndarray</code>=<em><code>None</code></em>, <strong><code>parallel</code></strong>:<code>bool</code>=<em><code>False</code></em>)</p>
</blockquote>
<p>Function to extract score columns when giving a recordarray with PSMs.</p>
<p>Args:
    psms (np.recarray): Recordarray containing PSMs.
    query_masses (np.ndarray): Array with query masses.
    query_masses_raw (np.ndarray): Array with raw query masses.
    query_frags (np.ndarray): Array with frag types of the query data.
    query_ints (np.ndarray): Array with fragment intensities from the query.
    query_indices (np.ndarray): Array with indices to the query data.
    db_masses (np.ndarray): Array with database masses.
    db_frags (np.ndarray): Array with fragment masses.
    frag_types (np.ndarray): Array with fragment types.
    mtol (float): Mass tolerance.
    db_indices (np.ndarray): Array with indices to the database array.
    ppm (bool): Flag to use ppm instead of Dalton.
    psms_dtype (list): List describing the dtype of the PSMs record array.
    db_ints (np.ndarray, optional): Array with database intensities. Defaults to None.
    parallel (bool, optional): Flag to use parallel processing. Defaults to False.</p>
<p>Returns:
    np.recarray: Recordarray containing PSMs with additional columns.
    np.ndarray: NumPy array containing ion information.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_sequences" class="doc_header"><code>get_sequences</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L605" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_sequences</code>(<strong><code>psms</code></strong>:<code>recarray</code>, <strong><code>db_seqs</code></strong>:<code>ndarray</code>)</p>
</blockquote>
<p>Get sequences to add them to a recarray</p>
<p>Args:
    psms (np.recarray): Recordarray containing PSMs.
    db_seqs (np.ndarray): NumPy array containing sequences.</p>
<p>Returns:
    np.ndarray: NumPy array containing a subset of sequences.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_score_columns" class="doc_header"><code>get_score_columns</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L623" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_score_columns</code>(<strong><code>psms</code></strong>:<code>recarray</code>, <strong><code>query_data</code></strong>:<code>dict</code>, <strong><code>db_data</code></strong>:<code>Union</code>[<code>dict</code>, <code>str</code>], <strong><code>features</code></strong>:<code>DataFrame</code>, <strong><code>parallel</code></strong>:<code>bool</code>, <strong><code>frag_tol</code></strong>:<code>float</code>, <strong><code>prec_tol</code></strong>:<code>float</code>, <strong><code>ppm</code></strong>:<code>bool</code>, <strong><code>m_offset_calibrated</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>float</code>]=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Wrapper function to extract score columns.</p>
<p>Args:
    psms (np.recarray): Recordarray containing PSMs.
    query_data (dict): Data structure containing the query data.
    db_data: Union[dict, str]: Data structure containing the database data or path to database.
    features (pd.DataFrame): Pandas dataframe containing feature data.
    parallel (bool): Flag to use parallel processing.
    frag_tol (float): Fragment tolerance for search.
    prec_tol (float): Precursor tolerance for search.
    ppm (bool): Flag to use ppm instead of Dalton.
    m_offset_calibrated (Union[None, float], optional): Calibrated offset mass. Defaults to None.</p>
<p>Returns:
    np.recarray: Recordarray containing PSMs with additional columns.
    np.ndarray: NumPy array containing ion information.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Plot">Plot<a class="anchor-link" href="#Plot"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="plot_psms" class="doc_header"><code>plot_psms</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L809" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>plot_psms</code>(<strong><code>query_data</code></strong>:<code>dict</code>, <strong><code>df</code></strong>:<code>DataFrame</code>, <strong><code>index</code></strong>:<code>int</code>, <strong><code>mass_dict</code></strong>:<code>dict</code>, <strong><code>ppm</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>frag_tol</code></strong>:<code>float</code>=<em><code>20</code></em>)</p>
</blockquote>
<p>Helper function to plot as PSMs</p>
<p>Args:
    query_data (dict): Data structure containing the query data.
    df (pd.DataFrame): DataFrame contianing PSMs.
    index (int): Index to DataFrame.
    mass_dict (dict): Dictionary containing masses.
    ppm (bool, optional): Flag to use ppm instead of Dalton. Defaults to True.
    frag_tol (float, optional): Fragment tolerance. Defaults to 20.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">alphapept.io</span>
<span class="kn">from</span> <span class="nn">alphapept.constants</span> <span class="kn">import</span> <span class="n">mass_dict</span>

<span class="n">ms_file</span> <span class="o">=</span> <span class="n">alphapept</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">MS_Data_File</span><span class="p">(</span><span class="s1">&#39;../testfiles/test.ms_data.hdf&#39;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">ms_file</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">dataset_name</span><span class="o">=</span><span class="s1">&#39;peptide_fdr&#39;</span><span class="p">)</span>
<span class="n">query_data</span> <span class="o">=</span> <span class="n">ms_file</span><span class="o">.</span><span class="n">read_DDA_query_data</span><span class="p">()</span>

<span class="n">plot_psms</span><span class="p">(</span><span class="n">query_data</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">mass_dict</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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kCFDOOaYY/IOq1mZP38+Q4YMYcMNN+S6667LO5xm4ZxzzuGuu+6iXbt2y6dNmDCB1VZzHcWqeOyxx7jsssuYNm0aXbp04Uc/+hHf+ta38g6rxXFC1kp07dqVww47jDfeeIPHH38873CshA4dOnDppZfSu3dvnn/+eX7wgx+wwQYbsNVWW+UdWouz//77873vfY8OHTowe/Zshg8fTp8+fRg8eHDeoTUbl19+OX379mXZsmV5h9KsfPe73+XEE0/MO4wW77XXXuOss85ixIgRbLfddnz44YcsWLAg77BaJCdkLcjo0aN57rnnuPDCC5dPu+iii5DEqaeeCsA//vGPnKKzQuW8VwBbbrklX/3qV3nmmWeckBVRblkCSGLGjBlNHWJu6iubZ555hldffZVvf/vb3HrrrTlG2vRKlY2tnFJl+f777zNkyBC23357IFUOdO3aNa9QWzTXz7Yge+21Fw8//PDy/z6WLl3K3Xff7ctdzVC579Unn3zClClT2GijjfIIs0WoryxHjRrFjjvuyF577cXChQvZY4898gy3SZUqm2XLlnHBBRdw2mmnVWUSUt95M3bsWAYPHsx3vvMd7r///jxDbfZKleWzzz4LwNChQ9l999352c9+xvz58/MMt8VyQtaCrLPOOvTv3597770XgIcffpi11lqLr3zlKzlHZrWV+16dd955bLLJJgwcODCPMFuE+spy2LBh/Oc//+HGG29k7733plOnTnmG26RKlc1NN93ElltuWbXfD6XK5tBDD+WWW27hnnvu4fvf/z7nnHMOTz/9dM4RN1+lynL27NnccccdXHTRRdxyyy188sknK9SkWfmckLUw++yzD3feeScAd955J3vttVfOEVkx9b1Xl112Ga+++irnn39+VdZgrIz6ylISm266KWussQZXX311HiHmpq6ymTNnDjfddBMnnXRSztHlq9h5s9lmm9G1a1fatGnDDjvswB577OFasnoUK8s11liDfffdl969e7Pmmmty9NFH89BDD+UZaovlhKyFGTRoEFOnTuXVV1/lwQcfZM8998w7JCui1Ht1zTXX8NBDD3HllVfSsWPHHKNsGco975cuXVpVbcig7rKZMmUK7777LgcddBC77bYbF198MVOmTGG33Xarqsb95Z43koiIJo6uZSlWlhtvvPEK/1D6n8tV54SshVl99dXZZZddOOuss9hiiy344he/CMCyZctYvHgxS5cuJSJYvHgxn376ac7RVrdi79X111/PXXfdxVVXXeXGr2WqqyyXLVvGuHHjmD9/PhHBlClTuPnmm9l2223zDrdJ1VU222+/Pf/85z8ZM2YMY8aM4YQTTmDTTTdlzJgxVdW1Q7HP4H333cfHH3/MsmXLeOSRR7jzzjvZaaedco62eStWlvvttx///Oc/eeutt1i0aNHyNp228qrnk9mK7LPPPrzyyisrXLb517/+xfbbb8+vf/1rnnrqKbbffnvOPffcHKM0qPu9uvLKK5k1axYHHHAAO+64IzvuuCN//OMfc4yyZairLB944AEOOOAAvvnNb/Kzn/2MoUOHMnTo0ByjzEftsll99dXp3r378kenTp1o27Yt3bt3zznSplfXeTNmzBj23HNPBg0axGWXXcbZZ5/NNttsk2OULUNdZbnffvux9957c9RRR7HPPvuw+uqrf+7uZyuPWnI17YABA2LSpEl5h9HkZs2axYEHHsjdd9/ty13NnN+rxuOyLM5lU5zLpvG4LBtO0hMRMaCuea4ha2GWLVvGjTfeyO677+4PRDPn96rxuCyLc9kU57JpPC7LynPHsC3IwoUL2W233ejZsye/+93v8g7HSvB71XhclsW5bIpz2TQel2UTiYgW+9hmm22iqeyzzz7x6KOPNtn+WjOXZXEum+JcNo3HZdly+L1qXYBJUSSn8SXLBlqyZAmnnXYa++67LwMGDOCJJ57IO6QW69lnn+XEE09k8ODB7Lrrrpx++um8++67eYfVLLz22msceeSR7Lzzzuy8886ceOKJvPbaa3mH1ez84Q9/YMCAATz22GN5h9Iivf322wwYMGD5zSY77rgj1157bd5hWRGLFi3i/PPPZ5dddmGnnXbie9/7Xt4hWQP4kmUj6NevH4cffjinn3563qG0aAsWLGDIkCEMHDiQNm3acOGFFzJixAhXkQM9evTgggsuoGfPnkQEN998M2eeeSY33XRT3qE1GzNmzODee+9lnXXWyTuUFm/8+PG0adMm7zCsHr/61a9YunQpY8eOpWvXrrz00kt5h2QN4BqylTBlyhQOPvhgdt55Z0aMGMHixYtp164dhx9+OP369fMX2Eqoqyy33357dt11Vzp27Ej79u055JBDqnI4k7rKpnPnzqy33nrLO7BcbbXVmD59et6h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o0ZBYw0lU0m+zG3WpJyQmZmZWasyY8YM9t9/fzbeeGM22mgjhg8fzieffJJ3WCU5IWuoYv9F+r9LMzOzJhcRDBkyhAMOOICpU6cydepUFi5c2CjjVZbq36yhnJCZmZlZq3H//ffTvn17jj76aADatGnDpZdeyujRo7niiisYPnz48mX32Wcfxo8fD8DdDzzAwIED6d+/PwcffDAffvghAH369OH000+nf//+nH/++fTv33/5+lOnTl3hdUO4p34zMzOrnMa6WrRgQfr7gx+UXGzKlClss802K0zr0qULffr04dNPP61znXfnzuXcSy7h3nvvpWPHjlxwwQVccskl/PznPwege/fuPPnkkwDce++9TJ48mX79+nH99dcvT/waygmZmZmZVbVHnniC519+mR122AGAxYsXM3DgwOXzhw4duvz5cccdx/XXX88ll1zCX//6Vx577LFGicEJmZmZmVVOY43HXGa3FJtvvjljx45dYdr8+fOZNWsW3bt35+WCu5wXLVoEpHZn39ppJ8aMG1fnNjt27Lj8+YEHHsiIESMYPHgw22yzDd27d1/ZI6mT25CZmZlZq7HLLrvw8ccfM3r0aCA1xP/JT37C8OHD6du3L5MnT2bZsmVMnz59ee3W17fZhocee4xXXnkFgI8++miFxK1Q+/bt2X333fn+97/faJcrwQmZmZmZtSKSuOWWWxg7diwbb7wx3bt3Z7XVVuOss85ihx12oG/fvmy++eacfPLJyxvk91hnHUb97nccdthhbLXVVgwcOJAXX3yx6D6OOOIIVlttNXbbbbdGi9uXLM3MzKxV2WCDDbjtttsAePjhhznssMN48skn6d+/PzfeeOPnV3j3XQbvuCOPP/7452a98cYbn5s2ceJEjj76aNq0adNoMTshMzMzs1Zr++23Z9q0aY22vW9/+9u8+uqr3H///Y22TXBCZmZmZla2W265pSLbdRsyMzMzs5w5ITMzM7NGFRF5h5CrVTl+J2RmZmbWaNq3b8/cuXOrNimLCObOnUv79u1Xaj23ITMzM7NG06tXL2bMmMGcOXMad8PZ2JI09nYrsO327dvTq1evlVqn2SVkkvYALgPaANdGxPk5h2RmZmZlateuHX379m38DdeMidlYPf831bbL1KwuWUpqA1wJ7AlsDhwmafN8ozIzMzOrrGaVkAHbAq9ExGsRsRi4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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Searching-with-database">Searching with database<a class="anchor-link" href="#Searching-with-database"> </a></h2><p>We save intermediate results to hdf5 files</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="store_hdf" class="doc_header"><code>store_hdf</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L911" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>store_hdf</code>(<strong><code>df</code></strong>:<code>DataFrame</code>, <strong><code>path</code></strong>:<code>str</code>, <strong><code>key</code></strong>:<code>str</code>, <strong><code>replace</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>swmr</code></strong>:<code>bool</code>=<em><code>False</code></em>)</p>
</blockquote>
<p>Wrapper function to store a DataFrame in an hdf.</p>
<p>Args:
    df (pd.DataFrame): DataFrame to be stored.
    path (str): Target path of the hdf file.
    key (str): Name of the field to be saved.
    replace (bool, optional): Flag whether the field should be replaced.. Defaults to False.
    swmr (bool, optional): Flag to use swmr(single write multiple read)-mode. Defaults to False.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="search_db" class="doc_header"><code>search_db</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L938" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>search_db</code>(<strong><code>to_process</code></strong>:<code>tuple</code>, <strong><code>callback</code></strong>:<code>Callable</code>=<em><code>None</code></em>, <strong><code>parallel</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>first_search</code></strong>:<code>bool</code>=<em><code>True</code></em>)</p>
</blockquote>
<p>Wrapper function to perform database search to be used by a parallel pool.</p>
<p>Args:
    to_process (tuple): Tuple containing an index to the file and the experiment settings.
    callback (Callable, optional): Callback function to indicate progress. Defaults to None.
    parallel (bool, optional): Flag to use parallel processing. Defaults to False.
    first_search (bool, optional): Flag to indicate this is the first search. Defaults to True.</p>
<p>Returns:
    Union[bool, str]: Returns True if the search was successfull, otherwise returns a string containing the Exception.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Searching-Large-Fasta-and-or-Search-Space">Searching Large Fasta and or Search Space<a class="anchor-link" href="#Searching-Large-Fasta-and-or-Search-Space"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="search_fasta_block" class="doc_header"><code>search_fasta_block</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L1024" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>search_fasta_block</code>(<strong><code>to_process</code></strong>:<code>tuple</code>)</p>
</blockquote>
<p>Search fasta block. This file digests per block and does not use a saved database.
For searches with big fasta files or unspecific searches.</p>
<p>Args:
    to_process (tuple): Tuple containing a fasta_index, fasta_block, a list of files and a list of experimental settings.</p>
<p>Returns:
    list: A list of dataframes when searching the respective file.
    int: Number of new peptides that were generated in this iteration.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="filter_top_n" class="doc_header"><code>filter_top_n</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L1131" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>filter_top_n</code>(<strong><code>temp</code></strong>:<code>DataFrame</code>, <strong><code>top_n</code></strong>:<code>int</code>=<em><code>10</code></em>)</p>
</blockquote>
<p>Takes a dataframe and keeps only the top n entries (based on hits).
Combines fasta indices for sequences.</p>
<p>Args:
    temp (pd.DataFrame): Pandas DataFrame containing PSMs.
    top_n (int, optional): Number of top-n entries to be kept. Defaults to 10.</p>
<p>Returns:
    pd.DataFrame: Filtered DataFrame.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="search_parallel" class="doc_header"><code>search_parallel</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L1165" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>search_parallel</code>(<strong><code>settings</code></strong>:<code>dict</code>, <strong><code>calibration</code></strong>:<code>Optional</code>[<code>list</code>]=<em><code>None</code></em>, <strong><code>callback</code></strong>:<code>Optional</code>[<code>Callable</code>]=<em><code>None</code></em>)</p>
</blockquote>
<p>Function to search multiple ms_data files in parallel.</p>
<p>Args:
    settings (dict): Settings file containg the experimental definitions.
    calibration (Union[list, None], optional): List of calibrated offsets.. Defaults to None.
    callback (Union[Callable, None], optional): Callback function. Defaults to None.</p>
<p>Returns:
    dict: FASTA dictionary.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

