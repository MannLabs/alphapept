---

title: Search

keywords: fastai
sidebar: home_sidebar

summary: "Functions related to the search"
description: "Functions related to the search"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 05_search.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This notebook contains all functions related to the searching and getting peptide-spectrum-matches (PSMS).</p>
<p>Current ToDo here:</p>
<ul>
<li>Most of the functions are not very well described yet</li>
<li>A key ingredient of speed is the frag_hits matrix to store the results which should be described</li>
<li>Introductory text to give an overview would be nice.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Comparing-Fragments">Comparing Fragments<a class="anchor-link" href="#Comparing-Fragments"> </a></h2><p>To efficiently compare two fragments, we use a pointer based approach. We start with two sorted arrays, the <code>query_frag</code> that contains the m/z positions of the query spectrum and the <code>db_frag</code> which contains the database fragment that is compared against to. The two pointers compare each m/z position with each other and check wheter they are within a certain tolerance <code>mtol</code>. Depending on their delta, either of the pointers is advanced. The function returns an arrray named <code>hits</code> that is the same length as the database spectrum and encodes the hit positions.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="compare_frags" class="doc_header"><code>compare_frags</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L12" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>compare_frags</code>(<strong><code>query_frag</code></strong>, <strong><code>db_frag</code></strong>, <strong><code>mtol</code></strong>, <strong><code>ppm</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Compare query and database frags and find hits</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">query_frag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">400</span><span class="p">])</span>
<span class="n">db_frag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">150</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">450</span><span class="p">])</span>

<span class="c1"># Hits: Query 2 -&gt; Db 2 and Query 3 -&gt; Db 3</span>

<span class="n">compare_frags</span><span class="p">(</span><span class="n">query_frag</span><span class="p">,</span> <span class="n">db_frag</span><span class="p">,</span> <span class="n">mtol</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([0, 2, 3, 0], dtype=int16)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This function allows us to easily compare a query spectrum against a theoretical database.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">alphapept</span> <span class="k">import</span> <span class="n">constants</span>
<span class="kn">from</span> <span class="nn">alphapept.fasta</span> <span class="k">import</span> <span class="n">get_frag_dict</span><span class="p">,</span> <span class="n">parse</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">peptide</span> <span class="o">=</span> <span class="s1">&#39;PEPTIDE&#39;</span>

<span class="c1"># Theoretical Spectrum</span>

<span class="n">frag_dict</span> <span class="o">=</span> <span class="n">get_frag_dict</span><span class="p">(</span><span class="n">parse</span><span class="p">(</span><span class="n">peptide</span><span class="p">),</span> <span class="n">constants</span><span class="o">.</span><span class="n">mass_dict</span><span class="p">)</span>
<span class="n">db_frag</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">frag_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="n">db_frag</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

<span class="n">db_int</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">db_frag</span><span class="p">]</span>

<span class="c1"># Experimental Spectrum, dummy data</span>

<span class="n">query_frag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">98.06</span><span class="p">,</span> <span class="mf">227.10</span><span class="p">,</span> <span class="mf">263.08</span><span class="p">,</span> <span class="mf">548.06</span><span class="p">,</span> <span class="mf">653.31</span><span class="p">])</span>
<span class="n">query_int</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">])</span>

<span class="n">hits</span> <span class="o">=</span> <span class="n">compare_frags</span><span class="p">(</span><span class="n">query_frag</span><span class="p">,</span> <span class="n">db_frag</span><span class="p">,</span> <span class="n">mtol</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">hitpos</span> <span class="o">=</span> <span class="n">hits</span><span class="p">[</span><span class="n">hits</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">hit_x</span> <span class="o">=</span> <span class="n">query_frag</span><span class="p">[</span><span class="n">hitpos</span><span class="p">]</span>
<span class="n">hit_y</span> <span class="o">=</span> <span class="n">query_int</span><span class="p">[</span><span class="n">hitpos</span><span class="p">]</span>


<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">db_frag</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">db_int</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;DB&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">query_frag</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">query_int</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Query&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hit_x</span><span class="p">,</span> <span class="n">hit_y</span><span class="p">,</span> <span class="s2">&quot;ro&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Hit&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">frag_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">frag_dict</span><span class="p">[</span><span class="n">_</span><span class="p">],</span> <span class="mi">104</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Theoretical Spectrum for </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">peptide</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Mass&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Intensity&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">110</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>C:\ProgramData\Anaconda3\lib\site-packages\numba\ir_utils.py:1959: NumbaPendingDeprecationWarning: 
Encountered the use of a type that is scheduled for deprecation: type &#39;reflected list&#39; found for argument &#39;db_frag&#39; of function &#39;compare_frags&#39;.

For more information visit http://numba.pydata.org/numba-doc/latest/reference/deprecation.html#deprecation-of-reflection-for-list-and-set-types

File &#34;alphapept\search.py&#34;, line 13:
@njit(nogil=True)
def compare_frags(query_frag, db_frag, mtol, ppm=False):
^

  warnings.warn(NumbaPendingDeprecationWarning(msg, loc=loc))
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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xVx11VVNut0OHTpwxRVX0K9fP55//nm++tWvsssuuzBo0KAm3W5T6N27N5deeil9+vQhpcRtt93Gd7/7XW699da8S6vV8ccfzxe+8AU6dOjAwoULGTlyJP379+fQQw/Nu7R3mT17Nvfff3+T/wehsfz85z9nwIABVFVV5V3KVnvwwQcpLS1t1m1+/vOf5ytf+UqzbrM5rFq1aoMwtiXz5s0jpcTuu+9OaWnpBjNrLcXq1auZM2dOTahcv379Jj/3EUHPnj1ZtGhRvbbR+qN4M5o2bRonnXQSH//4x7n44otZs2YNZWVlfPazn2Xw4MHN/od5YxMnTuTCCy/cYOyyyy7jpz/9KQcccACHH344vXvXevqTbVJt79eBBx7IsGHD6NSpE+Xl5Xz605/mmWeeaZTtba7/X/rSl+jfvz8lJSXss88+fOADH2Dq1KmNst2mVFsPu3Tpwk477UREkFKipKSE119/Pdc6N9f7XXfddYPZj4iomd3LQ209rXbZZZdx/vnn12s3R1PZXE8Bpk6dysyZMzn22GPzKK9BNtf7prClHm7LagtjlZWVzJw5kxdffJG5c+dSVVXF6tWrWbFiBX369KFdu3ZExAZ/XpvT4sWL3/V3w/z585k/fz6LFy+mW7dudO7cmYigXbt2bLfddpt8rrqG0WIGsnq4++67GT9+PH/605947bXXuO666/IuaQNHHXUUjz32GCtWrABg/fr1TJ48maOOOirnyvJRl/frqaeearRdbXXt/+rVq5k2bVqL3cVXbHM9POSQQxg6dCg/+clPct8FuKXe33jjjRx88MEcddRRVFZWcuSRR+ZW66Z6et9999GuXTsOOuig3GortrmeVlVVcemll3LhhRc26B+evGzu83zMMcdw1FFHcfHFF/Pmm282yva29Lm8/fbbOfTQQzn11FN54IEHGmWbLdmyZcvo168f73nPe1izZg2LFy+msrKSsrIyFi1axIsvvsjMmTNZvnz5Vm+rc+fOG9y/8cYbGTlyJADXXHMNEydOrBmfO3cuUNiTtHLlStavXw8Udj0uX76ciooK3n77bQBmzpzJSy+9xJw5c2rWaywGsno4+eSTa/YZn3322fztb3/Lu6QN9OrVi/3224/77rsPgMcee4xu3brxvve9L+fK8rGl92vGjBlcd911fO1rX2uU7dW1/z/+8Y/ZY489GDp0aKNstyltrocPPvggDz30EBdeeCF77rlnjlVuufdnnHEGDz/8MDfffDNHH330u/6ybk619fTtt9/m6quvZtSoUbnVtbHN9fTWW29ln332aXV/t9TW+27dujFx4kTuuusufvvb3/LWW2/xve99r1G2t7kefuYzn+GOO+5g8uTJfPnLX2bs2LGNNlvfUvXo0YOysjJKS0vp1asXy5cvZ926daxevZrS0lIGDhzIjjvuyNy5c1m9enWT1XHuuefy+c9/HtgwkJWVldGxY8eaQLhy5UpKS0vp0KED69atY9myZfTt25fdd9+dlBLz589v1LoMZPWwww471Nzu06dPvfcPN4djjjmGu+++Gyj8b7Ctzo7B5t+v119/nfPPP59Ro0bxgQ98oNG2uaX+X3nllcycOZNLLrmkVcwsbOkz36FDB0488UQuuugi3njjjeYubwNb6n1EsOeee9K+fXuuueaaPEoEau/pr371K4466ih22mmn3OqqTW09XbRoEbfeeivnnXdeztXVX22979ixI3vttRelpaX06NGDb3/72/zrX//irbfeapRtbupz+d73vpeKigpKS0s56KCDOPLII7f5WbJ27d45bL2srIy1a9cSEZS/9BK9xo+n5Jxz6PSTn9Bt1ixWrlzZZHWMHTuWcePGcfvttzNlyhQ+97nPMXjwYCorK6moqGDZsmVAYUavoqICKPz90a1bN9q3b09paSk9e/Zs9BoNZPWwYMGCmtvz589vkcdjHXLIIcyYMYOZM2fyyCOP8IlPfCLvknKzqfdr3rx5fOUrX+Gcc85p9MC6uf7/6le/4h//+AdXX311rd80aonq8plPKbFq1arc/4NS18/++vXrcz2GrLae/vvf/+bWW29l+PDhDB8+nAULFjB69Ghuuumm3OqE2ns6bdo0Fi9ezKc+9SmGDx/OuHHjmDZtGsOHD2/xB/fX5fNc/R+llFKjbLOun8vqYzK3ZevWrau5vXbtWsrKyujw8sv0uOEGWLoU+vaFpUvpMmECpdOmbdW2KisrGTx4cM3loosuetc6n/rUpxgyZAg333wzTz/9NB06dKBLly6sXr2aVatWsXLlyppAVl5evlX11IXfsqyH2267jYMPPpjy8nJ+/etfM3z4cIANDgxdu3ZtzcH+ecyAbLfddhx22GGMGTOGvffemx133BEofK143bp1rF+/npQSa9asoaSkZIP/sWxranu/Fi5cyLnnnstJJ53EiSee2Ojb3FT/b7jhBu655x6uvfbamj/grUFtPXz88cfp1q0bAwcOpLKykl/84hd07dq1Xl/vbgq19b6qqoo//vGPDBs2jC5duvD8889z2223ceaZZ+ZWZ209PfXUUzf4x+q0007jggsu4MADD8ytTqi9pz169ODPf/5zzTr33nsv99xzD5dffnmLP2VDbb1/7rnn6NKlC7vssgsrVqzgJz/5Cfvvv3+j7dbe1N8J999/P0OHDqW8vJwnnniCu+++myuuuKJRttlSvfHGG3Tu3JmSkhIWL15M165d6fCb37CmWzfebt+ejhGs69yZ1R070nXyZPjoRxu8rQ4dOvD000/X3L/xxhvr9NvXJSUldOnShTlz5tChQ4eaL9h069aNRYsWUVFRQbt27ViyZEmjH/qw7f5r3ASOPPJIzjvvPBYtWsTHPvYxzj77bABOPPFE5s2bB1Bz0OCdd96Z2+6HY445hj/+8Y8b/I/gL3/5CxdffHHN/QMPPJBjjjmGsWPH5lBh86jt/Zo4cSJz5szh2muv5dprr61Z95FHHmm07dbW/6uvvpqysjI++clP1oydeeaZuR8MvyW19fDRRx/lsssuY+HChbRv35699tqLq666arPfOGoutfX+73//O+PHj2ft2rX07t2bk08+mZNPPjm3Gmvr6cb/+y4tLaVr16507NgxpyrfsXFPt9tuO3r27FmzvHPnzrRr126DsZaqtt4/9NBDXH311bzxxht06tSJD33oQ/z4xz9u1O3W9rm85ZZb+MEPfkBKiZ133pnvfe97LfIclo2poqKCWbNmsW7dOjp37kyvXr2I11+n8847s+Ktt6isrKSkpIROffrQbs6c3Ors1q0bb7755gaf6W7durF27Vr++9//AoXPfXW4bizRmqdIhwwZkuqSeNua+fPnc+KJJ3Lvvfe2ml1j2xL7nx973/js6dZraz2cPn163b/wMXZsYXdl9+7vjFXf34oJg86dO29wjFf1DNn48eMZO3YsnTt3ZtSoURx77LFccMEFfPzjH69Zd+3atcycOZOBAwdu1emsautDRDyZUhpS2/ote35Z9VZVVcXNN9/MEUcc0Sb+4Lc09j8/9r7x2dOtZw+3YMSIQgBbuhSqqt65PWJEs2z+jDPO4Nxzz605qL/6LPtdu3Zt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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Comparing-Spectra">Comparing Spectra<a class="anchor-link" href="#Comparing-Spectra"> </a></h2><p>To compare multiple spectra against a database, we first need some helper functions. Per default, AlphaPept calculates in Dalton. To use ppm boundaries, we need the function <a href="/alphapept/search#ppm_to_dalton"><code>ppm_to_dalton</code></a> for conversion.</p>
<p>To minimize the search space, we typically only compare spectra with precursors in the same mass range as defined by <code>m_offset</code>. To look up the limits for search, we define the function <a href="/alphapept/search#get_idxs"><code>get_idxs</code></a>, which is a wrapper to the fast <code>searchsorted</code> method from NumPy.</p>
<p>The actual search takes place in <a href="/alphapept/search#compare_specs_single"><code>compare_specs_single</code></a> and <a href="/alphapept/search#compare_specs_parallel"><code>compare_specs_parallel</code></a>, a single-core and multicore method for comparing spectra.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ppm_to_dalton" class="doc_header"><code>ppm_to_dalton</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L45" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ppm_to_dalton</code>(<strong><code>mass</code></strong>, <strong><code>m_offset</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_idxs" class="doc_header"><code>get_idxs</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L53" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_idxs</code>(<strong><code>db_masses</code></strong>, <strong><code>query_masses</code></strong>, <strong><code>m_offset</code></strong>, <strong><code>ppm</code></strong>)</p>
</blockquote>
<p>Function to get upper and lower limits to define search range.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="compare_specs_parallel" class="doc_header"><code>compare_specs_parallel</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L68" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>compare_specs_parallel</code>(<strong><code>frag_hits</code></strong>, <strong><code>query_masses</code></strong>, <strong><code>query_frags</code></strong>, <strong><code>db_masses</code></strong>, <strong><code>db_frags</code></strong>, <strong><code>idxs_lower</code></strong>, <strong><code>idxs_higher</code></strong>, <strong><code>mtol</code></strong>, <strong><code>query_bounds</code></strong>, <strong><code>db_bounds</code></strong>, <strong><code>chunk</code></strong>=<em><code>(0, 1)</code></em>, <strong><code>offset</code></strong>=<em><code>False</code></em>, <strong><code>ppm</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Compare spectra, parallelized version</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="compare_specs_single" class="doc_header"><code>compare_specs_single</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L120" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>compare_specs_single</code>(<strong><code>frag_hits</code></strong>, <strong><code>query_masses</code></strong>, <strong><code>query_frags</code></strong>, <strong><code>db_masses</code></strong>, <strong><code>db_frags</code></strong>, <strong><code>idxs_lower</code></strong>, <strong><code>idxs_higher</code></strong>, <strong><code>mtol</code></strong>, <strong><code>query_bounds</code></strong>, <strong><code>db_bounds</code></strong>, <strong><code>chunk</code></strong>=<em><code>(0, 1)</code></em>, <strong><code>offset</code></strong>=<em><code>False</code></em>, <strong><code>ppm</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Compare spectra, single core version</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Wrapper">Wrapper<a class="anchor-link" href="#Wrapper"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="query_data_to_features" class="doc_header"><code>query_data_to_features</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L178" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>query_data_to_features</code>(<strong><code>query_data</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_psms" class="doc_header"><code>get_psms</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L196" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_psms</code>(<strong><code>query_data</code></strong>, <strong><code>db_data</code></strong>, <strong><code>features</code></strong>, <strong><code>parallel</code></strong>, <strong><code>m_tol</code></strong>, <strong><code>m_offset</code></strong>, <strong><code>ppm</code></strong>, <strong><code>min_frag_hits</code></strong>, <strong><code>callback</code></strong>=<em><code>None</code></em>, <strong><code>m_offset_calibrated</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Wrapper function to extract psms from dataset</p>
<p>Args:
    db_masses: database precursor masses
    query_masses: query precursor masses
    m_offset: mass offset in dalton or ppm
    ppm: flag for ppm or dalton
    callback: Callback function, e.g. for progress bar
Returns:
    idxs_lower: lower search range
    idxs_higher: upper search range
Raises:</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Extracting-columns-for-scoring">Extracting columns for scoring<a class="anchor-link" href="#Extracting-columns-for-scoring"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Frag-Delta">Frag Delta<a class="anchor-link" href="#Frag-Delta"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="frag_delta" class="doc_header"><code>frag_delta</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L343" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>frag_delta</code>(<strong><code>query_frag</code></strong>, <strong><code>db_frag</code></strong>, <strong><code>hits</code></strong>)</p>
</blockquote>
<p>Calculate the mass difference for a given array of hits in Dalton and ppm</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Intensity-Fraction">Intensity Fraction<a class="anchor-link" href="#Intensity-Fraction"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="intensity_fraction" class="doc_header"><code>intensity_fraction</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L357" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>intensity_fraction</code>(<strong><code>query_int</code></strong>, <strong><code>hits</code></strong>)</p>
</blockquote>
<p>Calculate the fraction of matched intensity</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">### Intensity Product</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="intensity_product" class="doc_header"><code>intensity_product</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L372" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>intensity_product</code>(<strong><code>query_int</code></strong>, <strong><code>hits</code></strong>, <strong><code>db_int</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Calculate the dot product of matched query intensity to db intensity</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="B-&amp;-Y---Hits">B &amp; Y - Hits<a class="anchor-link" href="#B-&amp;-Y---Hits"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="b_y_hits" class="doc_header"><code>b_y_hits</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L388" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>b_y_hits</code>(<strong><code>frag_type</code></strong>, <strong><code>hits</code></strong>)</p>
</blockquote>
<p>Count the number of b and y hits
hits usually start with b-ions (0), then y-ions (1)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="score_parallel" class="doc_header"><code>score_parallel</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L404" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>score_parallel</code>(<strong><code>psms</code></strong>, <strong><code>query_masses</code></strong>, <strong><code>query_frags</code></strong>, <strong><code>query_ints</code></strong>, <strong><code>db_masses</code></strong>, <strong><code>db_frags</code></strong>, <strong><code>frag_types</code></strong>, <strong><code>mtol</code></strong>, <strong><code>query_bounds</code></strong>, <strong><code>db_bounds</code></strong>, <strong><code>ppm</code></strong>, <strong><code>db_ints</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Extract values to calculate a score. Parallel version.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="score_single" class="doc_header"><code>score_single</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L473" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>score_single</code>(<strong><code>psms</code></strong>, <strong><code>query_masses</code></strong>, <strong><code>query_frags</code></strong>, <strong><code>query_ints</code></strong>, <strong><code>db_masses</code></strong>, <strong><code>db_frags</code></strong>, <strong><code>frag_types</code></strong>, <strong><code>mtol</code></strong>, <strong><code>query_bounds</code></strong>, <strong><code>db_bounds</code></strong>, <strong><code>ppm</code></strong>, <strong><code>db_ints</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Extract values to calculate a score. Single core version.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">### Extracting Score columns</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="add_column" class="doc_header"><code>add_column</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L543" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>add_column</code>(<strong><code>recarray</code></strong>, <strong><code>column</code></strong>, <strong><code>name</code></strong>)</p>
</blockquote>
<p>Function to add a column with given name to recarray</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="remove_column" class="doc_header"><code>remove_column</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L555" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>remove_column</code>(<strong><code>recarray</code></strong>, <strong><code>name</code></strong>)</p>
</blockquote>
<p>Function to remove a column from recarray</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_sequences" class="doc_header"><code>get_sequences</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L564" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_sequences</code>(<strong><code>psms</code></strong>, <strong><code>db_seqs</code></strong>)</p>
</blockquote>
<p>Get sequences to add them to a recarray</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_score_columns" class="doc_header"><code>get_score_columns</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L573" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_score_columns</code>(<strong><code>psms</code></strong>, <strong><code>query_data</code></strong>, <strong><code>db_data</code></strong>, <strong><code>features</code></strong>, <strong><code>parallel</code></strong>, <strong><code>m_tol</code></strong>, <strong><code>m_offset</code></strong>, <strong><code>ppm</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Plot">Plot<a class="anchor-link" href="#Plot"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="plot_hit" class="doc_header"><code>plot_hit</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L685" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>plot_hit</code>(<strong><code>df</code></strong>, <strong><code>index</code></strong>, <strong><code>db_bounds</code></strong>, <strong><code>db_frags</code></strong>, <strong><code>frag_types</code></strong>, <strong><code>query_bounds</code></strong>, <strong><code>query_frags</code></strong>, <strong><code>query_ints</code></strong>, <strong><code>ppm</code></strong>, <strong><code>m_tol</code></strong>, <strong><code>db_ints</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Wrapper">Wrapper<a class="anchor-link" href="#Wrapper"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="perform_search" class="doc_header"><code>perform_search</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/search.py#L756" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>perform_search</code>(<strong><code>query_files</code></strong>, <strong><code>db_masses</code></strong>, <strong><code>db_frags</code></strong>, <strong><code>db_bounds</code></strong>, <strong><code>db_seqs</code></strong>, <strong><code>frag_types</code></strong>, <strong><code>plot</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Function to search and score one or multiple MS runs by the X!Tandem approach.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

