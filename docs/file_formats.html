---

title: AlphaPept workflow and files


keywords: fastai
sidebar: home_sidebar



nb_path: "nbs/file_formats.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/file_formats.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Output-Files">Output Files<a class="anchor-link" href="#Output-Files"> </a></h2><p>For each run, AlphaPept creates several output files:</p>
<ul>
<li>For each raw file, there will a <code>.ms_data.hdf</code>-file with raw-specific data, such as <code>feature_table</code>, <code>first_search</code>, <code>second_search</code> and <code>peptide_fdr</code>.</li>
<li>For the entire experiment, there will be a <code>results.hdf</code> (name can be defined in the settings), which contains experiment-specific data, such as <code>protein_fdr</code> and the <code>protein_table</code> (containing quantified proteins over all files).</li>
<li>Additionally to the <code>results.hdf</code>, there will be a <code>*.yaml</code>-file which contains the run settings and summary information of the run. This <code>*.yaml</code> can be used to serve as a template to rerun other files with the same settings.</li>
<li>If a database is created from <code>FASTA</code>-files there will be a <code>database.hdf</code> (name can be defined in the settings). This contains theoretical spectra and can be reused for other experiments (and speedup total analysis time)</li>
</ul>
<p>The <code>ms_data.hdf</code>, <code>results.hdf</code> and database containers can be accessed via the <code>alphapept.io</code> library. The GUI also allows to explore these files. Additionally, the <code>results.hdf</code> can be directly loaded via the pandas-package (e.g. <code>pd.read_hdf('results.hdf', 'protein_table')</code>.</p>
<p>For easier access, AlphaPept directly exports the most relevant tables as <code>*.csv</code>:</p>
<ul>
<li><code>results.csv</code>: The search results after protein_fdr</li>
<li><code>results_proteins.csv</code>: The quantified proteins per file.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Column-headers">Column headers<a class="anchor-link" href="#Column-headers"> </a></h2><p>Below is a description of the column headers in the output files.</p>
<h3 id="protein_fdr">protein_fdr<a class="anchor-link" href="#protein_fdr"> </a></h3><table>
<thead><tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>abs_delta_m_ppm</td>
<td>absolute value  of <code>delta_m</code> in ppm</td>
</tr>
<tr>
<td>b-H2O_hits</td>
<td>b-ion hit with a water loss</td>
</tr>
<tr>
<td>b-NH3 hits</td>
<td>b-ion hit with a NH3 loss</td>
</tr>
<tr>
<td>b_hits</td>
<td>number of b ion hits</td>
</tr>
<tr>
<td>charge</td>
<td>charge of the peptide</td>
</tr>
<tr>
<td>db_idx</td>
<td>index to the theoretical database</td>
</tr>
<tr>
<td>decoy</td>
<td>is the sequence a decoy or a hit (Yes / No)</td>
</tr>
<tr>
<td>decoys_cum</td>
<td>cumulative number of decoys in table (used for FDR calculation)</td>
</tr>
<tr>
<td>delta_m</td>
<td>mean mass delta when comparing experimental fragments to theoretical fragments when searching</td>
</tr>
<tr>
<td>delta_m_ppm</td>
<td><code>delta_m</code> in ppm</td>
</tr>
<tr>
<td>dist</td>
<td>a metric used to measure the distance of an MS1 feature (quantification) to a matching MS2 spectrum (identification). This is important in the mapping of MS1 features to MS2 spectra </td>
</tr>
<tr>
<td>fasta_index</td>
<td>index to the fasta file that you use for searching</td>
</tr>
<tr>
<td>fdr</td>
<td>calculated false discovery rate value for this peptide in the table. As the PSM score decreases more decoys will be found the FDR score increases until you reach your FDR threshold cutoff, below which we donâ€™t count any more hits.</td>
</tr>
<tr>
<td>feature_idx</td>
<td>index to feature table from feature finding</td>
</tr>
<tr>
<td>feature_rank</td>
<td>multiple ms1 features will be mapped to a single ms2 spectra. The rank indicates the how close the feature was to the spectrum in comparison to other features in close distance.</td>
</tr>
<tr>
<td>fwhm</td>
<td>fwhm of the feature</td>
</tr>
<tr>
<td>hits</td>
<td>total number of b- and y-ion hits. A hit occurs when a theoretical fragment can be found within the <code>frag_tol</code> of an experimentally recorded fragment</td>
</tr>
<tr>
<td>int_apex</td>
<td>intensity at feature apex</td>
</tr>
<tr>
<td>int_ratio</td>
<td>mean intensity ratio: matched database fragment intensity divided by experimental fragment intensity (if no db intensity is available it is set to 1)</td>
</tr>
<tr>
<td>int_sum</td>
<td>summed intensity of the MS1-feature</td>
</tr>
<tr>
<td>ion_idx</td>
<td>index to ion dataframe for this PSM</td>
</tr>
<tr>
<td>ion_int</td>
<td>intensity of each matched ion</td>
</tr>
<tr>
<td>ion_types</td>
<td>type of the matched ion</td>
</tr>
<tr>
<td>mass</td>
<td>mass </td>
</tr>
<tr>
<td>matched_int</td>
<td>sum of the intensity of fragments found in the PSM</td>
</tr>
<tr>
<td>matched_int_ratio</td>
<td>ratio of the matched_int to the total intensity in a spectrum</td>
</tr>
<tr>
<td>matched_ion_fraction</td>
<td>number of ions that were found (hits) divided by the number of AAs in the matched sequence</td>
</tr>
<tr>
<td>mz</td>
<td>mz</td>
</tr>
<tr>
<td>n_AA</td>
<td>number of AAs in the sequence</td>
</tr>
<tr>
<td>n_internal</td>
<td>number of internal cleavage sites</td>
</tr>
<tr>
<td>n_ions</td>
<td>number of matched ions</td>
</tr>
<tr>
<td>n_missed</td>
<td>number of missed cleavages</td>
</tr>
<tr>
<td>naked_sequence</td>
<td>naked sequence (i.e. withouth modifications)</td>
</tr>
<tr>
<td>o_mass</td>
<td>mass offset from theoretical precursor mass to actual precursor mass</td>
</tr>
<tr>
<td>o_mass_ppm</td>
<td>o_mass in ppm</td>
</tr>
<tr>
<td>o_mass_ppm_raw</td>
<td>o_mass_raw in ppm</td>
</tr>
<tr>
<td>o_mass_raw</td>
<td>mass offset from theoretical precursor mass to actual precursor mass (before recalibration)</td>
</tr>
<tr>
<td>precursor</td>
<td>peptide + charge</td>
</tr>
<tr>
<td>q_value</td>
<td>q_value for FDR estiamtion</td>
</tr>
<tr>
<td>query_idx</td>
<td>index to query (for the spectrum index use raw_idx)</td>
</tr>
<tr>
<td>rank</td>
<td>one query can have multiple matching PSMs. This is the rank of the PSM to the query with respect to the score. See also raw_rank</td>
</tr>
<tr>
<td>rank_precursor</td>
<td>if a precursor is measured multiple times, this is the rank with respect to the score</td>
</tr>
<tr>
<td>raw_idx</td>
<td>index to the experimental spectrum</td>
</tr>
<tr>
<td>raw_rank</td>
<td>one spectrum can have multiple matching PSMs. This is the rank of the PSM to the spectrum with respect to the score.</td>
</tr>
<tr>
<td>rt</td>
<td>retention time of the feature</td>
</tr>
<tr>
<td>rt_apex</td>
<td>retention time of the feature (at maximum intensity)</td>
</tr>
<tr>
<td>rt_end</td>
<td>end timepoint of feature</td>
</tr>
<tr>
<td>rt_start</td>
<td>start timepoint of feature</td>
</tr>
<tr>
<td>scan_no</td>
<td>scan number</td>
</tr>
<tr>
<td>score</td>
<td>score used for FDR estiamtion</td>
</tr>
<tr>
<td>sequence</td>
<td>matched sequence</td>
</tr>
<tr>
<td>target</td>
<td>boolean flag if sequence is target or decoy</td>
</tr>
<tr>
<td>target_cum</td>
<td>cumulative number of targets (used for FDR estiamtion)</td>
</tr>
<tr>
<td>total_int</td>
<td>summed intensity of all fragments in experimental spectrum</td>
</tr>
<tr>
<td>x_tandem</td>
<td>x_tandem score</td>
</tr>
<tr>
<td>y-H2O_hits</td>
<td>number of y-ion hits with water loss</td>
</tr>
<tr>
<td>y-NH3_hits</td>
<td>number of y-ion hits with ammonia loss</td>
</tr>
<tr>
<td>y_hits</td>
<td>number of y-ion hits</td>
</tr>
<tr>
<td>filename</td>
<td>full filename of raw data</td>
</tr>
<tr>
<td>shortname</td>
<td>short filename of raw data (w/o folder path)</td>
</tr>
<tr>
<td>protein</td>
<td>identified protein</td>
</tr>
<tr>
<td>protein_group</td>
<td>identified protein_group</td>
</tr>
<tr>
<td>razor</td>
<td>flag if peptide was used for protein grouping with razor approach</td>
</tr>
<tr>
<td>protein_idx</td>
<td>index to protein (with respect to FASTA)</td>
</tr>
<tr>
<td>decoy_protein</td>
<td>flag if protein is decoy or not</td>
</tr>
<tr>
<td>n_possible_proteins</td>
<td>number of possible proteins for this peptide</td>
</tr>
<tr>
<td>score_protein_group</td>
<td>score of the protein group</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Downstream-analysis">Downstream analysis<a class="anchor-link" href="#Downstream-analysis"> </a></h2><p>AlphaPept offers some basic plots in the results section (e.g., volcano, heatmap, and PCA). The <code>*.csv</code>-format should be generic to use with multiple other tools. Feel free to reach out in case you have ideas for plots or find that the output format not supported or has required columns missing. To reach out, report an issue <a href="https://github.com/MannLabs/alphapept/issues/new/choose">here</a> or send an email to opensource@alphapept.com.</p>
<h3 id="Using-with-Perseus">Using with Perseus<a class="anchor-link" href="#Using-with-Perseus"> </a></h3><p>Perseus offers a generic table import, so you can directly use the <code>results_proteins.csv</code>.</p>
<h4 id="Example:-Volcano-Plot">Example: Volcano-Plot<a class="anchor-link" href="#Example:-Volcano-Plot"> </a></h4><p>An excellent tutorial for creating volcano-plots with Perseus can be found <a href="http://www.coxdocs.org/doku.php?id=perseus:user:use_cases:interactions">here</a>.</p>
<p>Below a quickstart to use AlphaPept with Perseus (tested with <code>1.6.15.0</code>) The file used here is <code>PXD006109</code> from the test runner (multi-species quantification test) with six files (three each group).</p>
<ol>
<li><p>Open Perseus.
{% include image.html align="center" file="/images/workflow/perseus_0.PNG" %}</p>
</li>
<li><p>Drag and drop the <code>results_proteins.csv</code> in the central pane of Perseus. The <code>Generic matrix upload</code>-window will open.
{% include image.html align="center" file="/images/workflow/perseus_1.PNG" %}</p>
</li>
<li><p>Select the appropriate columns (e.g., LFQ for LFQ-intensities) and select them for Main with the <code>&gt;</code>-Button. The first row is empty. Assign this for text. Click <code>OK,</code> and the table should be loaded.
{% include image.html align="center" file="/images/workflow/perseus_2.PNG" %}</p>
</li>
<li><p>Click on the <code>f(x)</code>-button and press <code>OK</code> on the window that opens to apply a <code>log2(x)</code>-transformation.
{% include image.html align="center" file="/images/workflow/perseus_3.PNG" %}</p>
</li>
<li><p>Click on <code>Annot. rows</code> &gt; <code>Categorical annotation rows</code> to assign a group for each file. Select multiple entries and click on the checkmark to assign multiple groups at the same time. Click <code>OK</code> to close the window.
{% include image.html align="center" file="/images/workflow/perseus_4.PNG" %}</p>
</li>
<li><p>Click on the <code>Volcano plot</code>-symbol in the upper right <code>Analysis</code>-column. For the tutorial, we keep the standard settings and press <code>OK</code>.</p>
</li>
<li><p>You can double-click on the small volcano plot to show the plot.
{% include image.html align="center" file="/images/workflow/perseus_5.PNG" %}</p>
</li>
</ol>
<p>Enjoy your volcano-plot.</p>

</div>
</div>
</div>
</div>
 

