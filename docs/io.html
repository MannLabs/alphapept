---

title: Input / Output

keywords: fastai
sidebar: home_sidebar

summary: "Functions related to input and output"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs\02_io.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This notebook contains all functions related to importing and exporting files. The current way of handling data is to store as a *.npz container.</p>
<p>Current ToDo here:</p>
<ul>
<li>The functions are not well described yet and proper callbacks are also not implemented.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Conversion-functions">Conversion functions<a class="anchor-link" href="#Conversion-functions">&#182;</a></h2><p>To bring spectra in a usable form, we perform several conversion steps.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_most_abundant" class="doc_header"><code>get_most_abundant</code><a href="__main__.py#L12" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_most_abundant</code>(<strong><code>mass</code></strong>, <strong><code>intensity</code></strong>, <strong><code>n_max</code></strong>)</p>
</blockquote>
<p>Returns the n_max most abundant peaks of a spectrum</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="calculate_mass" class="doc_header"><code>calculate_mass</code><a href="__main__.py#L31" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>calculate_mass</code>(<strong><code>mono_mz</code></strong>, <strong><code>charge</code></strong>)</p>
</blockquote>
<p>Calculate the precursor mass from mono mz and charge</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Reading-Thermo-Files">Reading Thermo Files<a class="anchor-link" href="#Reading-Thermo-Files">&#182;</a></h2><p>ToDo: This only works when using MSFileReader and and installed Terhmo version</p>
<p>Implementation Note: While creating a lot of different lists an filling them with list comprehensions, this may create a lot of variables. However, the approach seemd to work reasonable fast.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="load_thermo_raw" class="doc_header"><code>load_thermo_raw</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/io.py#L47" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>load_thermo_raw</code>(<strong><code>raw_file</code></strong>, <strong><code>most_abundant</code></strong>, <strong><code>callback</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Load thermo raw file and extract spectra</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Wrapper">Wrapper<a class="anchor-link" href="#Wrapper">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="parse_kwargs_path" class="doc_header"><code>parse_kwargs_path</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/io.py#L142" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>parse_kwargs_path</code>(<strong><code>kwargs</code></strong>, <strong><code>filetype</code></strong>=<em><code>'.raw'</code></em>)</p>
</blockquote>
<p>Checks the raw_path of the kwargs, replaces it when a list of rawfiles if this is a folder</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="raw_to_npz" class="doc_header"><code>raw_to_npz</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/io.py#L173" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>raw_to_npz</code>(<strong><code>kwargs</code></strong>, <strong><code>callback</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Wrapper function to convert raw to npz</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Bruker">Bruker<a class="anchor-link" href="#Bruker">&#182;</a></h2><p>ToDo: Combine these functions with the wrapper raw to npz
We should also be able to speed this up</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="load_bruker_raw" class="doc_header"><code>load_bruker_raw</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/io.py#L203" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>load_bruker_raw</code>(<strong><code>raw_file</code></strong>, <strong><code>most_abundant</code></strong>, <strong><code>callback</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Load bruker raw file and extract spectra</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="check_sanity" class="doc_header"><code>check_sanity</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/io.py#L268" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>check_sanity</code>(<strong><code>mass_list</code></strong>)</p>
</blockquote>
<p>Sanity check for mass list to make sure the masses are sorted</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="extract_mzml_info" class="doc_header"><code>extract_mzml_info</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/io.py#L280" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>extract_mzml_info</code>(<strong><code>input_dict</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="extract_mzxml_info" class="doc_header"><code>extract_mzxml_info</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/io.py#L297" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>extract_mzxml_info</code>(<strong><code>input_dict</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="read_mzML" class="doc_header"><code>read_mzML</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/io.py#L310" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>read_mzML</code>(<strong><code>filename</code></strong>, <strong><code>most_abundant</code></strong>)</p>
</blockquote>
<p>Read spectral data from an mzML file and return various lists separately for ms1 and ms2 data.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="read_mzXML" class="doc_header"><code>read_mzXML</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/io.py#L382" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>read_mzXML</code>(<strong><code>filename</code></strong>, <strong><code>most_abundant</code></strong>)</p>
</blockquote>
<p>Read spectral data from an mzXML file and return various lists separately for ms1 and ms2 data.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Saving">Saving<a class="anchor-link" href="#Saving">&#182;</a></h2><p>For saving, we are currently relying on the NumPy-native npz-container. It offers reasonable speed, dictionary-type access, and does not need individual type definitions.</p>
<p>While we could, in principle, store the mz and int arrays as a list of variable length, this will come at a performance decrase. We, therefore, create an array of the dimensions of the n most abundant peaks and number of spectra with the function <a href="/alphapept/io#list_to_numpy_f32"><code>list_to_numpy_f32</code></a> and fill the unoccupied cells with <code>-1</code>. This allows an increase in accessing times at the cost of additional disk space.</p>
<p>Implementation Note: For large files (e.g., choosing a large number of peaks that should be kept, the npz array can fail and trigger an ZIP64 error. This is supposed to be fixed in a later NumPy version.)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="list_to_numpy_f32" class="doc_header"><code>list_to_numpy_f32</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/io.py#L456" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>list_to_numpy_f32</code>(<strong><code>long_list</code></strong>)</p>
</blockquote>
<p>Function to convert a list to float32 array</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="save_query_as_npz" class="doc_header"><code>save_query_as_npz</code><a href="https://github.com/mannlabs/alphapept/tree/master/alphapept/io.py#L473" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>save_query_as_npz</code>(<strong><code>raw_file_npz</code></strong>, <strong><code>query_data</code></strong>)</p>
</blockquote>
<p>Saves query_data as npz</p>

</div>

</div>

</div>
</div>

</div>
</div>
 

