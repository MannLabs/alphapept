# GitHub Actions to automatically test on sample files
name: Quick Test

on:
  push:
    branches: [ master, develop]
  pull_request:
    branches: [ master , develop]

jobs:
  Install_Alphapept:
    runs-on: self-hosted
    steps:
    - uses: actions/checkout@v2
    - name: Install package
      run: |
        conda create --name alphapept python=3.8 -y
        conda activate alphapept
        pip install -e .
        pip install pymongo
        pip install dnspython
        pip install wget
  IRT_Thermo_Win:
    needs: Install_Alphapept
    runs-on: self-hosted
    steps:
    - uses: actions/checkout@v2
    - name: Run Alphapept on Thermo
      run: |
        python test_ci.py "${{ secrets.MONGODB_PW }}" thermo [thermo.raw] [IRT_fasta.fasta,contaminants.fasta]
  IRT_Bruker_Win:
    needs: [Install_Alphapept, IRT_Thermo_Win]
    runs-on: self-hosted
    steps:
    - uses: actions/checkout@v2
    - name: Run Alphapept on Bruker
      run: |
        python test_ci.py "${{ secrets.MONGODB_PW }}" bruker [bruker_IRT.d] [IRT_fasta.fasta,contaminants.fasta]
